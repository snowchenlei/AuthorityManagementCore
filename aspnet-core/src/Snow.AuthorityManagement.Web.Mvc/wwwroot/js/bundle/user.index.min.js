function setDate(n,t,i){var r,u;r=t?!1:!0;u=i?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD";n.daterangepicker({singleDatePicker:r,autoUpdateInput:!1,timePicker24Hour:!0,timePickerSeconds:!0,timePicker:!0,opens:"left",locale:{format:u,separator:" - ",applyLabel:"确定",cancelLabel:"清除",fromLabel:"起始时间",toLabel:"结束时间'",customRangeLabel:"自定义",weekLabel:"W",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1}},function(r,u){i===!0&&t===!0?$(n).val($.trim(r.format("YYYY-MM-DD HH:mm:ss")+"~"+u.format("YYYY-MM-DD HH:mm:ss"))):i===!1&&t===!0?$(n).val($.trim(r.format("YYYY-MM-DD")+"~"+u.format("YYYY-MM-DD"))):i===!1&&t===!1?$(n).val(r.format("YYYY-MM-DD")):i===!0&&t===!1&&$(n).val(r.format("YYYY-MM-DD HH:mm:ss"))}).on("cancel.daterangepicker",function(){$(this).val("")})}function queryParams(n){return{pageSize:n.limit,pageIndex:n.offset/n.limit+1,sort:n.sort,order:n.order,userName:$("#txt_search_userName").val(),date:$("#txt_search_addTime").val()}}(function(){function s(){var n=[];return n.push('<div class="btn-group" style="display: inline-block;" role="group" aria-label="...">'),isGranted("Pages.Users.Edit")&&n.push('<button type = "button" class="btn btn-sm btn-warning edit"><i class="far fa-edit"><\/i><\/button>'),isGranted("Pages.Users.Delete")&&n.push('<button type="button" class="btn btn-sm btn-danger remove"><i class="fas fa-trash"><\/i><\/button>'),n.push('<div class="btn-group" role="group">'),n.push('<button id="btnGroupDrop1" type="button" class="btn btn-sm btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'),n.push("Action"),n.push("<\/button>"),n.push('<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">'),n.push('<a class="dropdown-item" href="#">Dropdown link<\/a>'),n.push('<a class="dropdown-item" href="#">Dropdown link<\/a>'),n.push("<\/div>"),n.push("<\/div>"),n.push("<\/div>"),n.join("")}function u(i,r){t=bootbox.dialog({title:i,message:'<p><i class="fa fa-spin fa-spinner"><\/i> 加载中... <\/p>',size:"large",buttons:{cancel:{label:"取消",className:"btn-danger"},confirm:{label:"提交",className:"btn-success",callback:function(t){if(t)return n=Ladda.create(t.target),n.start(),r===undefined?h():c(r),!1}}}});t.init(function(){$.get("/User/CreateOrEdit",{id:r},function(n){t.find(".bootbox-body").html(n);t.find("input:not([type=hidden]):first").focus()})})}function f(t){return t.valid()?!0:(n.stop(),!1)}function e(n){var t=n.serializeFormToJson(),i=o(),r={user:t,roleIds:i};return JSON.stringify(r)}function h(){var r=$("#modelForm"),u;if(!f(r))return!1;u=e(r);$.ajax({type:"POST",url:i,contentType:"application/json",data:u,success:function(){n.stop();toastr.success("添加成功");refreshTable();t.modal("hide")},error:function(t){toastr.error(t.responseText);n.stop()}})}function c(r){var u=$("#modelForm"),o;if(!f(u))return!1;o=e(u);$.ajax({type:"PUT",url:i+r,contentType:"application/json",data:o,success:function(){n.stop();toastr.success("修改成功");refreshTable();t.modal("hide")},error:function(t){toastr.error(t.responseText);n.stop()}})}function o(){var n=[];return t.find("#RolesTab input[type=checkbox]").each(function(){$(this).is(":checked")&&n.push($(this).data("id"))}),n}var r,t,n,i;window.operateEvents={"click .edit":function(n,t,i){n.preventDefault();u("修改用户："+i.name,i.id)},"click .remove":function(n,t,r){bootbox.confirm({size:"small",title:"删除用户"+r.name,message:"你确定要删除"+r.name+"吗？",callback:function(n){n&&$.ajax({type:"DELETE",url:i+r.id,success:function(){var n=$("#tb-body");n.bootstrapTable("remove",{field:"id",values:[r.id]});toastr.success("删除成功")}})}})}};r=[{checkbox:!0},{title:"操作",formatter:s,events:operateEvents},{field:"id",title:"Id",visible:!1},{field:"phoneNumber",title:"手机号"},{field:"name",title:"名称"},{field:"userName",title:"用户名"}];$(function(){isGranted("Pages.Users.Create")||$("#btnAdd").remove();$("#create").click(function(){u("添加新用户")});table.init(r);loadPanel();setDate($("#txt_search_addTime"),!0,!0)});i="/api/users/"})();