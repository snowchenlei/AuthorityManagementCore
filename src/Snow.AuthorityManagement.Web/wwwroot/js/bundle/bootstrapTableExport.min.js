/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||function(n){"use strict";if(typeof n!="undefined"&&(typeof navigator=="undefined"||!/MSIE [1-9]\./.test(navigator.userAgent))){var s=n.document,r=function(){return n.URL||n.webkitURL||n},i=s.createElementNS("http://www.w3.org/1999/xhtml","a"),h="download"in i,c=function(n){var t=new MouseEvent("click");n.dispatchEvent(t)},l=/constructor/i.test(n.HTMLElement)||n.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(n.setImmediate||n.setTimeout)(function(){throw t;},0)},v="application/octet-stream",y=4e4,f=function(n){var t=function(){typeof n=="string"?r().revokeObjectURL(n):n.remove()};setTimeout(t,y)},p=function(n,t,i){var r,u;for(t=[].concat(t),r=t.length;r--;)if(u=n["on"+t[r]],typeof u=="function")try{u.call(n,i||n)}catch(f){a(f)}},e=function(n){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob([String.fromCharCode(65279),n],{type:n.type}):n},o=function(t,o,s){s||(t=e(t));var a=this,k=t.type,b=k===v,y,w=function(){p(a,"writestart progress write writeend".split(" "))},d=function(){var i,e;if((u||b&&l)&&n.FileReader){i=new FileReader;i.onloadend=function(){var t=u?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;"),r=n.open(t,"_blank");r||(n.location.href=t);t=undefined;a.readyState=a.DONE;w()};i.readAsDataURL(t);a.readyState=a.INIT;return}y||(y=r().createObjectURL(t));b?n.location.href=y:(e=n.open(y,"_blank"),e||(n.location.href=y));a.readyState=a.DONE;w();f(y)};if(a.readyState=a.INIT,h){y=r().createObjectURL(t);setTimeout(function(){i.href=y;i.download=o;c(i);w();f(y);a.readyState=a.DONE});return}d()},t=o.prototype,w=function(n,t,i){return new o(n,t||n.name||"download",i)};return typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob?function(n,t,i){return t=t||n.name||"download",i||(n=e(n)),navigator.msSaveOrOpenBlob(n,t)}:(t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,w)}}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content),$jscomp;typeof module!="undefined"&&module.exports?module.exports.saveAs=saveAs:typeof define!="undefined"&&define!==null&&define.amd!==null&&define("FileSaver.js",function(){return saveAs});$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(n,t,i){var f,r,u;for(n instanceof String&&(n=String(n)),f=n.length,r=0;r<f;r++)if(u=n[r],t.call(i,u,r,n))return{i:r,v:u};return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,t,i){n!=Array.prototype&&n!=Object.prototype&&(n[t]=i.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(n,t,i,r){if(t){for(i=$jscomp.global,n=n.split("."),r=0;r<n.length-1;r++){var u=n[r];u in i||(i[u]={});i=i[u]}n=n[n.length-1];r=i[n];t=t(r);t!=r&&null!=t&&$jscomp.defineProperty(i,n,{configurable:!0,writable:!0,value:t})}};$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(n,t){return $jscomp.findInternal(this,n,t).v}},"es6","es3"),function(n){n.fn.tableExport=function(t){function nt(t){var r=[];return ei(t,"tbody").each(function(){r.push.apply(r,oi(n(this),i.tbodySelector).toArray())}),i.tfootSelector.length&&ei(t,"tfoot").each(function(){r.push.apply(r,oi(n(this),i.tfootSelector).toArray())}),r}function ei(t,i){var r=t.parents("table").length;return t.find(i).filter(function(){return n(this).closest("table").parents("table").length===r})}function oi(t,r){return t.find(r).filter(function(){return 0==i.maxNestedTables||n(this).find("table").length<i.maxNestedTables&&n(this).parents("table").length<=i.maxNestedTables})}function wt(t){var i=[];return n(t).find("thead").first().find("th").each(function(t,r){i[t]=void 0!==n(r).attr("data-field")?n(r).attr("data-field"):t.toString()}),i}function ft(t){var u="undefined"!=typeof t[0].cellIndex,r="undefined"!=typeof t[0].rowIndex,f=u||r?ir(t):t.is(":visible"),i=t.data("tableexport-display");return u&&"none"!=i&&"always"!=i&&(t=n(t[0].parentNode),r="undefined"!=typeof t[0].rowIndex,i=t.data("tableexport-display")),r&&"none"!=i&&"always"!=i&&(i=t.closest("table").data("tableexport-display")),"none"!==i&&(1==f||"always"==i)}function ir(n){var t=[];return ct&&(t=rt.filter(function(){var t=!1;return this.nodeType==n[0].nodeType&&("undefined"!=typeof this.rowIndex&&this.rowIndex==n[0].rowIndex?t=!0:"undefined"!=typeof this.cellIndex&&this.cellIndex==n[0].cellIndex&&"undefined"!=typeof this.parentNode.rowIndex&&"undefined"!=typeof n[0].parentNode.rowIndex&&this.parentNode.rowIndex==n[0].parentNode.rowIndex&&(t=!0)),t})),0==ct||0==t.length}function rr(t,r,u){var f=!1;return ft(t)?0<i.ignoreColumn.length&&(-1!=n.inArray(u,i.ignoreColumn)||-1!=n.inArray(u-r,i.ignoreColumn)||st.length>u&&"undefined"!=typeof st[u]&&-1!=n.inArray(st[u],i.ignoreColumn))&&(f=!0):f=!0,f}function y(t,r,u,f,e){var s,h,o;"function"==typeof e&&(s=!1,"function"==typeof i.onIgnoreRow&&(s=i.onIgnoreRow(n(t),u)),!1===s&&-1==n.inArray(u,i.ignoreRow)&&-1==n.inArray(u-f,i.ignoreRow)&&ft(n(t))&&(h=n(t).find(r),o=0,h.each(function(t){var s=n(this),i,r=et(this),f=ot(this);if(n.each(k,function(){if(u>=this.s.r&&u<=this.e.r&&o>=this.s.c&&o<=this.e.c)for(i=0;i<=this.e.c-this.s.c;++i)e(null,u,o++)}),!1===rr(s,h.length,t)&&((f||r)&&(r=r||1,k.push({s:{r:u,c:o},e:{r:u+(f||1)-1,c:o+r-1}})),e(this,u,o++)),r)for(i=0;i<r-1;++i)e(null,u,o++)}),n.each(k,function(){if(u>=this.s.r&&u<=this.e.r&&o>=this.s.c&&o<=this.e.c)for(ri=0;ri<=this.e.c-this.s.c;++ri)e(null,u,o++)})))}function yi(n,t){if(!0===i.consoleLog&&console.log(n.output()),"string"===i.outputMode)return n.output();if("base64"===i.outputMode)return it(n.output());if("window"===i.outputMode)window.URL=window.URL||window.webkitURL,window.open(window.URL.createObjectURL(n.output("blob")));else try{var r=n.output("blob");saveAs(r,i.fileName+".pdf")}catch(u){b(i.fileName+".pdf","data:application/pdf"+(t?"":";base64")+",",t?n.output("blob"):n.output())}}function pi(n,t,i){var r=0;if("undefined"!=typeof i&&(r=i.colspan),0<=r){for(var u=n.width,f=n.textPos.x,o=t.table.columns.indexOf(t.column),e=1;e<r;e++)u+=t.table.columns[o+e].width;return 1<r&&("right"===n.styles.halign?f=n.textPos.x+u-n.width:"center"===n.styles.halign&&(f=n.textPos.x+(u-n.width)/2)),n.width=u,n.textPos.x=f,"undefined"!=typeof i&&1<i.rowspan&&(n.height*=i.rowspan),("middle"===n.styles.valign||"bottom"===n.styles.valign)&&(i=("string"==typeof n.text?n.text.split(/\r\n|\r|\n/g):n.text).length||1,2<i&&(n.textPos.y-=(2-1.15)/2*t.row.styles.fontSize*(i-2)/3)),!0}return!1}function wi(t,i,r){"undefined"!=typeof r.images&&i.each(function(){var i=n(this).children(),u;n(this).is("img")&&(u=nr(this.src),r.images[u]={url:this.src,src:this.src});"undefined"!=typeof i&&0<i.length&&wi(t,i,r)})}function ur(n,t){function f(n){if(n.url){var i=new Image;r=++u;i.crossOrigin="Anonymous";i.onerror=i.onload=function(){if(i.complete&&(0===i.src.indexOf("data:image/")&&(i.width=n.width||i.width||0,i.height=n.height||i.height||0),i.width+i.height)){var f=document.createElement("canvas"),e=f.getContext("2d");f.width=i.width;f.height=i.height;e.drawImage(i,0,0);n.src=f.toDataURL("image/jpeg")}--u||t(r)};i.src=n.url}}var i,r=0,u=0;if("undefined"!=typeof n.images)for(i in n.images)n.images.hasOwnProperty(i)&&f(n.images[i]);return(n=u)||(t(r),n=void 0),n}function bi(t,r,u){r.each(function(){var l=n(this).children(),h=0,r;if(n(this).is("div")){var o=kt(tt(this,"background-color"),[255,255,255]),c=kt(tt(this,"border-top-color"),[0,0,0]),s=dt(this,"border-top-width",i.jspdf.unit),e=this.getBoundingClientRect(),f=this.offsetLeft*u.dw;h=this.offsetTop*u.dh;r=e.width*u.dw;e=e.height*u.dh;u.doc.setDrawColor.apply(void 0,c);u.doc.setFillColor.apply(void 0,o);u.doc.setLineWidth(s);u.doc.rect(t.x+f,t.y+h,r,e,s?"FD":"F")}else if(n(this).is("img")&&"undefined"!=typeof u.images&&(o=nr(this.src),o=u.images[o],"undefined"!=typeof o)){c=t.width/t.height;s=this.width/this.height;f=t.width;r=t.height;e=19.049976/25.4;s<=c?(r=Math.min(t.height,this.height),f=this.width*r/this.height):s>c&&(f=Math.min(t.width,this.width),r=this.height*f/this.width);f*=e;r*=e;r<t.height&&(h=(t.height-r)/2);try{u.doc.addImage(o.src,t.textPos.x,t.y+h,f,r)}catch(a){}t.textPos.x+=f}"undefined"!=typeof l&&0<l.length&&bi(t,l,u)})}function ki(t,i,r){var e,s,u,o,l;if("function"==typeof r.onAutotableText)r.onAutotableText(r.doc,t,i);else{var f=t.textPos.x,h=t.textPos.y,c={halign:t.styles.halign,valign:t.styles.valign};if(i.length){for(i=i[0];i.previousSibling;)i=i.previousSibling;for(e=!1,s=!1;i;){if(u=i.innerText||i.textContent||"",u=(u.length&&" "==u[0]?" ":"")+n.trim(u)+(1<u.length&&" "==u[u.length-1]?" ":""),n(i).is("br")&&(f=t.textPos.x,h+=r.doc.internal.getFontSize()),n(i).is("b")?e=!0:n(i).is("i")&&(s=!0),(e||s)&&r.doc.setFontType(e&&s?"bolditalic":e?"bold":"italic"),o=r.doc.getStringUnitWidth(u)*r.doc.internal.getFontSize(),o){for("linebreak"===t.styles.overflow&&f>t.textPos.x&&f+o>t.textPos.x+t.width&&(0<=".,!%*;:=-".indexOf(u.charAt(0))&&(l=u.charAt(0),o=r.doc.getStringUnitWidth(l)*r.doc.internal.getFontSize(),f+o<=t.textPos.x+t.width&&(r.doc.autoTableText(l,f,h,c),u=u.substring(1,u.length)),o=r.doc.getStringUnitWidth(u)*r.doc.internal.getFontSize()),f=t.textPos.x,h+=r.doc.internal.getFontSize());u.length&&f+o>t.textPos.x+t.width;)u=u.substring(0,u.length-1),o=r.doc.getStringUnitWidth(u)*r.doc.internal.getFontSize();r.doc.autoTableText(u,f,h,c);f+=o}(e||s)&&(n(i).is("b")?e=!1:n(i).is("i")&&(s=!1),r.doc.setFontType(e||s?e?"bold":"italic":"normal"));i=i.nextSibling}t.textPos.x=f;t.textPos.y=h}else r.doc.autoTableText(t.text,t.textPos.x,t.textPos.y,c)}}function bt(n,t,i){return n.replace(new RegExp(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),i)}function si(n){return n=bt(n||"0",i.numbers.html.thousandsSeparator,""),n=bt(n,i.numbers.html.decimalMark,"."),"number"==typeof n||!1!==jQuery.isNumeric(n)?n:!1}function fr(n){return-1<n.indexOf("%")?(n=si(n.replace(/%/g,"")),!1!==n&&(n/=100)):n=!1,n}function v(t,r,u){var e="",h,f,c,o,l;if(null!==t){if(h=n(t),h[0].hasAttribute("data-tableexport-value"))f=(f=h.data("tableexport-value"))?f+"":"";else if(f=h.html(),"function"==typeof i.onCellHtmlData)f=i.onCellHtmlData(h,r,u,f);else if(""!=f){var s=n.parseHTML(f),a=0,v=0;f="";n.each(s,function(){n(this).is("input")?f+=h.find("input").eq(a++).val():n(this).is("select")?f+=h.find("select option:selected").eq(v++).text():"undefined"==typeof n(this).html()?f+=n(this).text():(void 0===jQuery().bootstrapTable||!0!==n(this).hasClass("filterControl")&&0===n(t).parents(".detail-view").length)&&(f+=n(this).html())})}!0===i.htmlContent?e=n.trim(f):f&&""!=f&&(""!=n(t).data("tableexport-cellformat")?(c=f.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"⁠"),o=n("<div/>").html(c).contents(),s=!1,c="",n.each(o.text().split("\u2028"),function(t,i){0<t&&(c+=" ");c+=n.trim(i)}),n.each(c.split("⁠"),function(t,i){0<t&&(e+="\n");e+=n.trim(i).replace(/\u00AD/g,"")}),"json"==i.type||"excel"===i.type&&"xmlss"===i.excelFileFormat||!1===i.numbers.output?(s=si(e),!1!==s&&(e=Number(s))):(i.numbers.html.decimalMark!=i.numbers.output.decimalMark||i.numbers.html.thousandsSeparator!=i.numbers.output.thousandsSeparator)&&(s=si(e),!1!==s)&&(o=(""+s.substr(0>s?1:0)).split("."),1==o.length&&(o[1]=""),l=3<o[0].length?o[0].length%3:0,e=(0>s?"-":"")+(i.numbers.output.thousandsSeparator?(l?o[0].substr(0,l)+i.numbers.output.thousandsSeparator:"")+o[0].substr(l).replace(/(\d{3})(?=\d)/g,"$1"+i.numbers.output.thousandsSeparator):o[0])+(o[1].length?i.numbers.output.decimalMark+o[1]:""))):e=f);!0===i.escape&&(e=escape(e));"function"==typeof i.onCellData&&(e=i.onCellData(h,r,u,e))}return e}function er(n,t,i){return t+"-"+i.toLowerCase()}function kt(n,t){return(n=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(n))&&(t=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])]),t}function di(n){var t=tt(n,"text-align"),u=tt(n,"font-weight"),r=tt(n,"font-style"),i="";return"start"==t&&(t="rtl"==tt(n,"direction")?"right":"left"),700<=u&&(i="bold"),"italic"==r&&(i+=r),""===i&&(i="normal"),t={style:{align:t,bcolor:kt(tt(n,"background-color"),[255,255,255]),color:kt(tt(n,"color"),[0,0,0]),fstyle:i},colspan:et(n),rowspan:ot(n)},null!==n&&(n=n.getBoundingClientRect(),t.rect={width:n.width,height:n.height}),t}function et(t){var i=n(t).data("tableexport-colspan");return"undefined"==typeof i&&n(t).is("[colspan]")&&(i=n(t).attr("colspan")),parseInt(i)||0}function ot(t){var i=n(t).data("tableexport-rowspan");return"undefined"==typeof i&&n(t).is("[rowspan]")&&(i=n(t).attr("rowspan")),parseInt(i)||0}function tt(n,t){try{return window.getComputedStyle?(t=t.replace(/([a-z])([A-Z])/,er),window.getComputedStyle(n,null).getPropertyValue(t)):n.currentStyle?n.currentStyle[t]:n.style[t]}catch(i){}return""}function dt(n,t,i){if(t=tt(n,t).match(/\d+/),null!==t){t=t[0];n=n.parentElement;var r=document.createElement("div");return r.style.overflow="hidden",r.style.visibility="hidden",n.appendChild(r),r.style.width=100+i,i=100/r.offsetWidth,n.removeChild(r),t*i}return 0}function hi(){if(!(this instanceof hi))return new hi;this.SheetNames=[];this.Sheets={}}function gi(n){for(var i=new ArrayBuffer(n.length),r=new Uint8Array(i),t=0;t!=n.length;++t)r[t]=n.charCodeAt(t)&255;return i}function or(n){for(var u,t,e,o,s,f={},i={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=n.length;++r)for(u=0;u!=n[r].length;++u)i.s.r>r&&(i.s.r=r),i.s.c>u&&(i.s.c=u),i.e.r<r&&(i.e.r=r),i.e.c<u&&(i.e.c=u),t={v:n[r][u]},null!==t.v&&(e=XLSX.utils.encode_cell({c:u,r:r}),"number"==typeof t.v?t.t="n":"boolean"==typeof t.v?t.t="b":t.v instanceof Date?(t.t="n",t.z=XLSX.SSF._table[14],o=t,s=(Date.parse(t.v)-new Date(Date.UTC(1899,11,30)))/864e5,o.v=s):t.t="s",f[e]=t);return 1e7>i.s.c&&(f["!ref"]=XLSX.utils.encode_range(i)),f}function nr(n){var t=0,r,i,u;if(0===n.length)return t;for(i=0,r=n.length;i<r;i++)u=n.charCodeAt(i),t=(t<<5)-t+u|0;return t}function b(n,t,i){var f=window.navigator.userAgent,r,u;if(!1!==n&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([i]),n);else if(!1!==n&&(0<f.indexOf("MSIE ")||f.match(/Trident.*rv\:11\./))){if(t=document.createElement("iframe")){document.body.appendChild(t);t.setAttribute("style","display:none");t.contentDocument.open("txt/plain","replace");t.contentDocument.write(i);t.contentDocument.close();t.contentDocument.focus();switch(n.substr(n.lastIndexOf(".")+1)){case"doc":case"json":case"png":case"pdf":case"xls":case"xlsx":n+=".txt"}t.contentDocument.execCommand("SaveAs",!0,n);document.body.removeChild(t)}}else r=document.createElement("a"),r&&(u=null,r.style.display="none",!1!==n?r.download=n:r.target="_blank","object"==typeof i?(window.URL=window.URL||window.webkitURL,u=window.URL.createObjectURL(i),r.href=u):r.href=0<=t.toLowerCase().indexOf("base64,")?t+it(i):t+encodeURIComponent(i),document.body.appendChild(r),document.createEvent?(null===gt&&(gt=document.createEvent("MouseEvents")),gt.initEvent("click",!0,!1),r.dispatchEvent(gt)):document.createEventObject?r.fireEvent("onclick"):"function"==typeof r.onclick&&r.onclick(),setTimeout(function(){u&&window.URL.revokeObjectURL(u);document.body.removeChild(r)},100))}function it(n){var r,o="",f=0,t,i,u,s,e;if("string"==typeof n){for(n=n.replace(/\x0d\x0a/g,"\n"),t="",r=0;r<n.length;r++)i=n.charCodeAt(r),128>i?t+=String.fromCharCode(i):(127<i&&2048>i?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(i&63|128));n=t}for(;f<n.length;)u=n.charCodeAt(f++),t=n.charCodeAt(f++),r=n.charCodeAt(f++),i=u>>2,u=(u&3)<<4|t>>4,s=(t&15)<<2|r>>6,e=r&63,isNaN(t)?s=e=64:isNaN(r)&&(e=64),o=o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);return o}var i={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelFileFormat:"xlshtml",excelPageOrientation:"portrait",excelRTL:!1,excelstyles:[],exportHiddenCells:!1,fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},onDocCreated:null,autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{doc:null,onAfterAutotable:null,onBeforeAutotable:null,onAutotableText:null,onTable:null,outputImages:!0}}},maxNestedTables:1,numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,onIgnoreRow:null,onMsoNumberFormat:null,outputMode:"file",pdfmake:{enabled:!1,docDefinition:{pageOrientation:"portrait",defaultStyle:{font:"Roboto"}},fonts:{}},tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"Table",type:"csv",worksheetName:""},h=this,gt=null,o=[],s=[],u=0,e="",st=[],k=[],rt=[],ct=!1,d,lt,ni,l,c,ht,ti,g,ci,ii,w,p,vt,li,ui,ai,vi,r;if(n.extend(!0,i,t),i.maxNestedTables=0<=i.maxNestedTables?i.maxNestedTables:1,st=wt(h),"csv"==i.type||"tsv"==i.type||"txt"==i.type){if(d="",lt=0,k=[],u=0,ni=function(t,r,f){return t.each(function(){e="";y(this,r,u,f+t.length,function(n,t,r){var f=e,u="";null!==n&&((n=v(n,t,r),t=null===n||""===n?"":n.toString(),"tsv"==i.type)?(n instanceof Date&&n.toLocaleString(),u=bt(t,"\t"," ")):n instanceof Date?u=i.csvEnclosure+n.toLocaleString()+i.csvEnclosure:(u=bt(t,i.csvEnclosure,i.csvEnclosure+i.csvEnclosure),0<=u.indexOf(i.csvSeparator)||/[\r\n ]/g.test(u))&&(u=i.csvEnclosure+u+i.csvEnclosure));e=f+(u+("tsv"==i.type?"\t":i.csvSeparator))});e=n.trim(e).substring(0,e.length-1);0<e.length&&(0<d.length&&(d+="\n"),d+=e);u++}),t.length},lt+=ni(n(h).find("thead").first().find(i.theadSelector),"th,td",lt),ei(n(h),"tbody").each(function(){lt+=ni(oi(n(this),i.tbodySelector),"td,th",lt)}),i.tfootSelector.length&&ni(n(h).find("tfoot").first().find(i.tfootSelector),"td,th",lt),d+="\n",!0===i.consoleLog&&console.log(d),"string"===i.outputMode)return d;if("base64"===i.outputMode)return it(d);if("window"===i.outputMode){b(!1,"data:text/"+("csv"==i.type?"csv":"plain")+";charset=utf-8,",d);return}try{l=new Blob([d],{type:"text/"+("csv"==i.type?"csv":"plain")+";charset=utf-8"});saveAs(l,i.fileName+"."+i.type,"csv"!=i.type||!1===i.csvUseBOM)}catch(sr){b(i.fileName+"."+i.type,"data:text/"+("csv"==i.type?"csv":"plain")+";charset=utf-8,"+("csv"==i.type&&i.csvUseBOM?"﻿":""),d)}}else if("sql"==i.type){if(u=0,k=[],c="INSERT INTO `"+i.tableName+"` (",o=n(h).find("thead").first().find(i.theadSelector),o.each(function(){y(this,"th,td",u,o.length,function(n,t,i){c+="'"+v(n,t,i)+"',"});u++;c=n.trim(c).substring(0,c.length-1)}),c+=") VALUES ",s=nt(n(h)),n(s).each(function(){e="";y(this,"td,th",u,o.length+s.length,function(n,t,i){e+="'"+v(n,t,i)+"',"});3<e.length&&(c+="("+e,c=n.trim(c).substring(0,c.length-1),c+="),");u++}),c=n.trim(c).substring(0,c.length-1),c+=";",!0===i.consoleLog&&console.log(c),"string"===i.outputMode)return c;if("base64"===i.outputMode)return it(c);try{l=new Blob([c],{type:"text/plain;charset=utf-8"});saveAs(l,i.fileName+".sql")}catch(sr){b(i.fileName+".sql","data:application/sql;charset=utf-8,",c)}}else if("json"==i.type){if(ht=[],k=[],o=n(h).find("thead").first().find(i.theadSelector),o.each(function(){var n=[];y(this,"th,td",u,o.length,function(t,i,r){n.push(v(t,i,r))});ht.push(n)}),ti=[],s=nt(n(h)),n(s).each(function(){var t={},i=0;y(this,"td,th",u,o.length+s.length,function(n,r,u){ht.length?t[ht[ht.length-1][i]]=v(n,r,u):t[i]=v(n,r,u);i++});!1===n.isEmptyObject(t)&&ti.push(t);u++}),t="",t="head"==i.jsonScope?JSON.stringify(ht):"data"==i.jsonScope?JSON.stringify(ti):JSON.stringify({header:ht,data:ti}),!0===i.consoleLog&&console.log(t),"string"===i.outputMode)return t;if("base64"===i.outputMode)return it(t);try{l=new Blob([t],{type:"application/json;charset=utf-8"});saveAs(l,i.fileName+".json")}catch(sr){b(i.fileName+".json","data:application/json;charset=utf-8;base64,",t)}}else if("xml"===i.type){if(u=0,k=[],g='<?xml version="1.0" encoding="utf-8"?>',g+="<tabledata><fields>",o=n(h).find("thead").first().find(i.theadSelector),o.each(function(){y(this,"th,td",u,o.length,function(n,t,i){g+="<field>"+v(n,t,i)+"<\/field>"});u++}),g+="<\/fields><data>",ci=1,s=nt(n(h)),n(s).each(function(){var n=1;e="";y(this,"td,th",u,o.length+s.length,function(t,i,r){e+="<column-"+n+">"+v(t,i,r)+"<\/column-"+n+">";n++});0<e.length&&"<column-1><\/column-1>"!=e&&(g+='<row id="'+ci+'">'+e+"<\/row>",ci++);u++}),g+="<\/data><\/tabledata>",!0===i.consoleLog&&console.log(g),"string"===i.outputMode)return g;if("base64"===i.outputMode)return it(g);try{l=new Blob([g],{type:"application/xml;charset=utf-8"});saveAs(l,i.fileName+".xml")}catch(sr){b(i.fileName+".xml","data:application/xml;charset=utf-8;base64,",g)}}else if("excel"===i.type&&"xmlss"===i.excelFileFormat){ii=[];w=[];n(h).filter(function(){return ft(n(this))}).each(function(){function f(t,i,r){var f=[];return n(t).each(function(){var o=0,i=0;e="";y(this,"td,th",u,r+t.length,function(t,r,s){var c,h;null!==t&&(c="",r=v(t,r,s),s="String",!1!==jQuery.isNumeric(r)?s="Number":(h=fr(r),!1!==h&&(r=h,s="Number",c+=' ss:StyleID="pct1"')),"Number"!==s&&(r=r.replace(/\n/g,"<br>")),h=et(t),t=ot(t),n.each(f,function(){if(u>=this.s.r&&u<=this.e.r&&i>=this.s.c&&i<=this.e.c)for(var n=0;n<=this.e.c-this.s.c;++n)i++,o++}),(t||h)&&(t=t||1,h=h||1,f.push({s:{r:u,c:i},e:{r:u+t-1,c:i+h-1}})),1<h&&(c+=' ss:MergeAcross="'+(h-1)+'"',i+=h-1),1<t&&(c+=' ss:MergeDown="'+(t-1)+'" ss:StyleID="rsp1"'),0<o&&(c+=' ss:Index="'+(i+1)+'"',o=0),e+="<Cell"+c+'><Data ss:Type="'+s+'">'+n("<div />").text(r).html()+"<\/Data><\/Cell>\r",i++)});0<e.length&&(p+='<Row ss:AutoFitHeight="0">\r'+e+"<\/Row>\r");u++}),t.length}var r=n(this),t="";"string"==typeof i.worksheetName&&i.worksheetName.length?t=i.worksheetName+" "+(w.length+1):"undefined"!=typeof i.worksheetName[w.length]&&(t=i.worksheetName[w.length]);t.length||(t=r.find("caption").text()||"");t.length||(t="Table "+(w.length+1));t=n.trim(t.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31));w.push(n("<div />").text(t).html());!1===i.exportHiddenCells&&(rt=r.find("tr, th, td").filter(":hidden"),ct=0<rt.length);u=0;st=wt(this);p="<Table>\r";t=0;t+=f(r.find("thead").first().find(i.theadSelector),"th,td",t);f(nt(r),"td,th",t);p+="<\/Table>\r";ii.push(p);!0===i.consoleLog&&console.log(p)});t={};for(var a={},f,ut,at=0,ri=w.length;at<ri;at++)f=w[at],ut=t[f],ut=t[f]=null==ut?1:ut+1,2==ut&&(w[a[f]]=w[a[f]].substring(0,29)+"-1"),1<t[f]?w[at]=w[at].substring(0,29)+"-"+t[f]:a[f]=at;for(t='<?xml version="1.0" encoding="UTF-8"?>\r<?mso-application progid="Excel.Sheet"?>\r<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:o="urn:schemas-microsoft-com:office:office"\r xmlns:x="urn:schemas-microsoft-com:office:excel"\r xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:html="http://www.w3.org/TR/REC-html40">\r<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\r  <Created>'+(new Date).toISOString()+'<\/Created>\r<\/DocumentProperties>\r<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">\r  <AllowPNG/>\r<\/OfficeDocumentSettings>\r<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\r  <WindowHeight>9000<\/WindowHeight>\r  <WindowWidth>13860<\/WindowWidth>\r  <WindowTopX>0<\/WindowTopX>\r  <WindowTopY>0<\/WindowTopY>\r  <ProtectStructure>False<\/ProtectStructure>\r  <ProtectWindows>False<\/ProtectWindows>\r<\/ExcelWorkbook>\r<Styles>\r  <Style ss:ID="Default" ss:Name="Normal">\r    <Alignment ss:Vertical="Bottom"/>\r    <Borders/>\r    <Font/>\r    <Interior/>\r    <NumberFormat/>\r    <Protection/>\r  <\/Style>\r  <Style ss:ID="rsp1">\r    <Alignment ss:Vertical="Center"/>\r  <\/Style>\r  <Style ss:ID="pct1">\r    <NumberFormat ss:Format="Percent"/>\r  <\/Style>\r<\/Styles>\r',a=0;a<ii.length;a++)t+='<Worksheet ss:Name="'+w[a]+'" ss:RightToLeft="'+(i.excelRTL?"1":"0")+'">\r'+ii[a],t=i.excelRTL?t+'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\r<DisplayRightToLeft/>\r<\/WorksheetOptions>\r':t+'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"/>\r',t+="<\/Worksheet>\r";if(t+="<\/Workbook>\r",!0===i.consoleLog&&console.log(t),"string"===i.outputMode)return t;if("base64"===i.outputMode)return it(t);try{l=new Blob([t],{type:"application/xml;charset=utf-8"});saveAs(l,i.fileName+".xml")}catch(sr){b(i.fileName+".xml","data:application/xml;charset=utf-8;base64,",t)}}else if("excel"==i.type||"xls"==i.type||"word"==i.type||"doc"==i.type){if(t="excel"==i.type||"xls"==i.type?"excel":"word",a="excel"==t?"xls":"doc",f='xmlns:x="urn:schemas-microsoft-com:office:'+t+'"',p="",vt="",n(h).filter(function(){return ft(n(this))}).each(function(){var t=n(this);""===vt&&(vt=i.worksheetName||t.find("caption").text()||"Table",vt=n.trim(vt.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31)));!1===i.exportHiddenCells&&(rt=t.find("tr, th, td").filter(":hidden"),ct=0<rt.length);u=0;k=[];st=wt(this);p+="<table><thead>";o=t.find("thead").first().find(i.theadSelector);o.each(function(){e="";y(this,"th,td",u,o.length,function(t,r,u){var f,s,o;if(null!==t){f="";e+="<th";for(s in i.excelstyles)i.excelstyles.hasOwnProperty(s)&&(o=n(t).css(i.excelstyles[s]),""!==o&&"0px none rgb(0, 0, 0)"!=o&&"rgba(0, 0, 0, 0)"!=o&&(f+=""===f?'style="':";",f+=i.excelstyles[s]+":"+o));""!==f&&(e+=" "+f+'"');f=et(t);0<f&&(e+=' colspan="'+f+'"');f=ot(t);0<f&&(e+=' rowspan="'+f+'"');e+=">"+v(t,r,u)+"<\/th>"}});0<e.length&&(p+="<tr>"+e+"<\/tr>");u++});p+="<\/thead><tbody>";s=nt(t);n(s).each(function(){var t=n(this);e="";y(this,"td,th",u,o.length+s.length,function(r,u,f){var c;if(null!==r){var h=v(r,u,f),s="",o=n(r).data("tableexport-msonumberformat");"undefined"==typeof o&&"function"==typeof i.onMsoNumberFormat&&(o=i.onMsoNumberFormat(r,u,f));"undefined"!=typeof o&&""!==o&&(s="style=\"mso-number-format:'"+o+"'");for(c in i.excelstyles)i.excelstyles.hasOwnProperty(c)&&(o=n(r).css(i.excelstyles[c]),""===o&&(o=t.css(i.excelstyles[c])),""!==o&&"0px none rgb(0, 0, 0)"!=o&&"rgba(0, 0, 0, 0)"!=o&&(s+=""===s?'style="':";",s+=i.excelstyles[c]+":"+o));e+="<td";""!==s&&(e+=" "+s+'"');u=et(r);0<u&&(e+=' colspan="'+u+'"');r=ot(r);0<r&&(e+=' rowspan="'+r+'"');"string"==typeof h&&""!=h&&(h=h.replace(/\n/g,"<br>"));e+=">"+h+"<\/td>"}});0<e.length&&(p+="<tr>"+e+"<\/tr>");u++});i.displayTableName&&(p+="<tr><td><\/td><\/tr><tr><td><\/td><\/tr><tr><td>"+v(n("<p>"+i.tableName+"<\/p>"))+"<\/td><\/tr>");p+="<\/tbody><\/table>";!0===i.consoleLog&&console.log(p)}),f='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+f+' xmlns="http://www.w3.org/TR/REC-html40">'+('<meta http-equiv="content-type" content="application/vnd.ms-'+t+'; charset=UTF-8">')+"<head>","excel"===t&&(f+="<!--[if gte mso 9]>",f+="<xml>",f+="<x:ExcelWorkbook>",f+="<x:ExcelWorksheets>",f+="<x:ExcelWorksheet>",f+="<x:Name>",f+=vt,f+="<\/x:Name>",f+="<x:WorksheetOptions>",f+="<x:DisplayGridlines/>",i.excelRTL&&(f+="<x:DisplayRightToLeft/>"),f+="<\/x:WorksheetOptions>",f+="<\/x:ExcelWorksheet>",f+="<\/x:ExcelWorksheets>",f+="<\/x:ExcelWorkbook>",f+="<\/xml>",f+="<![endif]-->"),f+="<style>","landscape"===i.excelPageOrientation&&(f+="@page { size:"+i.excelPageOrientation+"; mso-page-orientation:"+i.excelPageOrientation+"; }"),f+="br {mso-data-placement:same-cell;}",f+="<\/style>",f+="<\/head>",f+="<body>",f+=p,f+="<\/body>",f+="<\/html>",!0===i.consoleLog&&console.log(f),"string"===i.outputMode)return f;if("base64"===i.outputMode)return it(f);try{l=new Blob([f],{type:"application/vnd.ms-"+i.type});saveAs(l,i.fileName+"."+a)}catch(sr){b(i.fileName+"."+a,"data:application/vnd.ms-"+t+";base64,",f)}}else if("xlsx"==i.type){li=[];ui=[];u=0;s=n(h).find("thead").first().find(i.theadSelector).toArray();s.push.apply(s,nt(n(h)));n(s).each(function(){var t=[];y(this,"th,td",u,s.length,function(r,f,e){if("undefined"!=typeof r&&null!==r&&(e=v(r,f,e),f=et(r),r=ot(r),n.each(ui,function(){if(u>=this.s.r&&u<=this.e.r&&t.length>=this.s.c&&t.length<=this.e.c)for(var n=0;n<=this.e.c-this.s.c;++n)t.push(null)}),(r||f)&&(f=f||1,ui.push({s:{r:u,c:t.length},e:{r:u+(r||1)-1,c:t.length+f-1}})),"function"!=typeof i.onCellData&&""!==e&&e==+e&&(e=+e),t.push(""!==e?e:null),f))for(r=0;r<f-1;++r)t.push(null)});li.push(t);u++});t=new hi;a=or(li);a["!merges"]=ui;XLSX.utils.book_append_sheet(t,a,i.worksheetName);t=XLSX.write(t,{type:"binary",bookType:i.type,bookSST:!1});try{l=new Blob([gi(t)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});saveAs(l,i.fileName+"."+i.type)}catch(sr){b(i.fileName+"."+i.type,"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8,",gi(t))}}else if("png"==i.type)html2canvas(n(h)[0]).then(function(n){n=n.toDataURL();for(var t=atob(n.substring(22)),u=new ArrayBuffer(t.length),f=new Uint8Array(u),r=0;r<t.length;r++)f[r]=t.charCodeAt(r);if(!0===i.consoleLog&&console.log(t),"string"===i.outputMode)return t;if("base64"===i.outputMode)return it(n);if("window"===i.outputMode)window.open(n);else try{l=new Blob([u],{type:"image/png"});saveAs(l,i.fileName+".png")}catch(e){b(i.fileName+".png","data:image/png,",l)}});else if("pdf"==i.type)if(!0===i.pdfmake.enabled){for(t=[],ai=[],u=0,k=[],a=function(t,i,r){var f=0;return n(t).each(function(){var n=[];y(this,i,u,r,function(t,i,r){if("undefined"!=typeof t&&null!==t){var u=et(t),f=ot(t);t=v(t,i,r)||" ";1<u||1<f?n.push({colSpan:u||1,rowSpan:f||1,text:t}):n.push(t)}else n.push(" ")});n.length&&ai.push(n);f<n.length&&(f=n.length);u++}),f},o=n(this).find("thead").first().find(i.theadSelector),f=a(o,"th,td",o.length),ut=t.length;ut<f;ut++)t.push("*");s=nt(n(this));a(s,"th,td",o.length+s.length);t={content:[{table:{headerRows:o.length,widths:t,body:ai}}]};n.extend(!0,t,i.pdfmake.docDefinition);pdfMake.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}};n.extend(!0,pdfMake.fonts,i.pdfmake.fonts);pdfMake.createPdf(t).getBuffer(function(n){try{var t=new Blob([n],{type:"application/pdf"});saveAs(t,i.fileName+".pdf")}catch(r){b(i.fileName+".pdf","data:application/pdf;base64,",n)}})}else if(!1===i.jspdf.autotable)t={dim:{w:dt(n(h).first().get(0),"width","mm"),h:dt(n(h).first().get(0),"height","mm")},pagesplit:!1},vi=new jsPDF(i.jspdf.orientation,i.jspdf.unit,i.jspdf.format),vi.addHTML(n(h).first(),i.jspdf.margins.left,i.jspdf.margins.top,t,function(){yi(vi,!1)});else{if(r=i.jspdf.autotable.tableExport,"string"==typeof i.jspdf.format&&"bestfit"===i.jspdf.format.toLowerCase()){var yt={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},fi="",pt="",tr=0;n(h).each(function(){var t,i;if(ft(n(this))&&(t=dt(n(this).get(0),"width","pt"),t>tr)){t>yt.a0[0]&&(fi="a0",pt="l");for(i in yt)yt.hasOwnProperty(i)&&yt[i][1]>t&&(fi=i,pt="l",yt[i][0]>t&&(pt="p"));tr=t}});i.jspdf.format=""===fi?"a4":fi;i.jspdf.orientation=""===pt?"w":pt}if(null==r.doc&&(r.doc=new jsPDF(i.jspdf.orientation,i.jspdf.unit,i.jspdf.format),"function"==typeof i.jspdf.onDocCreated))i.jspdf.onDocCreated(r.doc);!0===r.outputImages&&(r.images={});"undefined"!=typeof r.images&&(n(h).filter(function(){return ft(n(this))}).each(function(){var t=0;k=[];!1===i.exportHiddenCells&&(rt=n(this).find("tr, th, td").filter(":hidden"),ct=0<rt.length);o=n(this).find("thead").find(i.theadSelector);s=nt(n(this));n(s).each(function(){y(this,"td,th",o.length+t,o.length+s.length,function(t){if("undefined"!=typeof t&&null!==t){var i=n(t).children();"undefined"!=typeof i&&0<i.length&&wi(t,i,r)}});t++})}),o=[],s=[]);ur(r,function(){n(h).filter(function(){return ft(n(this))}).each(function(){var f,t,e,h;if(u=0,k=[],!1===i.exportHiddenCells&&(rt=n(this).find("tr, th, td").filter(":hidden"),ct=0<rt.length),st=wt(this),r.columns=[],r.rows=[],r.rowoptions={},"function"==typeof r.onTable&&!1===r.onTable(n(this),i))return!0;if(i.jspdf.autotable.tableExport=null,t=n.extend(!0,{},i.jspdf.autotable),i.jspdf.autotable.tableExport=r,t.margin={},n.extend(!0,t.margin,i.jspdf.margins),t.tableExport=r,"function"!=typeof t.beforePageContent&&(t.beforePageContent=function(t){if(1==t.pageCount){var i=t.table.rows.concat(t.table.headerRow);n.each(i,function(){0<this.height&&(this.height+=(2-1.15)/2*this.styles.fontSize,t.table.height+=(2-1.15)/2*this.styles.fontSize)})}}),"function"!=typeof t.createdHeaderCell&&(t.createdHeaderCell=function(i,u){var f,e;i.styles=n.extend({},u.row.styles);"undefined"!=typeof r.columns[u.column.dataKey]&&(f=r.columns[u.column.dataKey],"undefined"!=typeof f.rect&&(i.contentWidth=f.rect.width,("undefined"==typeof r.heightRatio||0===r.heightRatio)&&(e=u.row.raw[u.column.dataKey].rowspan?u.row.raw[u.column.dataKey].rect.height/u.row.raw[u.column.dataKey].rowspan:u.row.raw[u.column.dataKey].rect.height,r.heightRatio=i.styles.rowHeight/e),e=u.row.raw[u.column.dataKey].rect.height*r.heightRatio,e>i.styles.rowHeight&&(i.styles.rowHeight=e)),"undefined"!=typeof f.style&&!0!==f.style.hidden&&(i.styles.halign=f.style.align,"inherit"===t.styles.fillColor&&(i.styles.fillColor=f.style.bcolor),"inherit"===t.styles.textColor&&(i.styles.textColor=f.style.color),"inherit"===t.styles.fontStyle&&(i.styles.fontStyle=f.style.fstyle)))}),"function"!=typeof t.createdCell&&(t.createdCell=function(n,i){i=r.rowoptions[i.row.index+":"+i.column.dataKey];"undefined"!=typeof i&&"undefined"!=typeof i.style&&!0!==i.style.hidden&&(n.styles.halign=i.style.align,"inherit"===t.styles.fillColor&&(n.styles.fillColor=i.style.bcolor),"inherit"===t.styles.textColor&&(n.styles.textColor=i.style.color),"inherit"===t.styles.fontStyle&&(n.styles.fontStyle=i.style.fstyle))}),"function"!=typeof t.drawHeaderCell&&(t.drawHeaderCell=function(n,t){var i=r.columns[t.column.dataKey];return(!0!==i.style.hasOwnProperty("hidden")||!0!==i.style.hidden)&&0<=i.rowIndex?pi(n,t,i):!1}),"function"!=typeof t.drawCell&&(t.drawCell=function(n,t){var i=r.rowoptions[t.row.index+":"+t.column.dataKey];return pi(n,t,i)&&((r.doc.rect(n.x,n.y,n.width,n.height,n.styles.fillStyle),"undefined"!=typeof i&&"undefined"!=typeof i.kids&&0<i.kids.length)?(t=n.height/i.rect.height,(t>r.dh||"undefined"==typeof r.dh)&&(r.dh=t),r.dw=n.width/i.rect.width,t=n.textPos.y,bi(n,i.kids,r),n.textPos.y=t,ki(n,i.kids,r)):ki(n,{},r)),!1}),r.headerrows=[],o=n(this).find("thead").find(i.theadSelector),o.each(function(){f=0;r.headerrows[u]=[];y(this,"th,td",u,o.length,function(n,t,i){var e=di(n);e.title=v(n,t,i);e.key=f++;e.rowIndex=u;r.headerrows[u].push(e)});u++}),0<u)for(e=u-1;0<=e;)n.each(r.headerrows[e],function(){var n=this;0<e&&null===this.rect&&(n=r.headerrows[e-1][this.key]);null!==n&&0<=n.rowIndex&&(!0!==n.style.hasOwnProperty("hidden")||!0!==n.style.hidden)&&r.columns.push(n)}),e=0<r.columns.length?-1:e-1;if(h=0,s=[],s=nt(n(this)),n(s).each(function(){var t=[];f=0;y(this,"td,th",u,o.length+s.length,function(i,u,e){if("undefined"==typeof r.columns[f]){var o={title:"",key:f,style:{hidden:!0}};r.columns.push(o)}"undefined"!=typeof i&&null!==i?(o=di(i),o.kids=n(i).children()):(o=n.extend(!0,{},r.rowoptions[h+":"+(f-1)]),o.colspan=-1);r.rowoptions[h+":"+f++]=o;t.push(v(i,u,e))});t.length&&(r.rows.push(t),h++);u++}),"function"==typeof r.onBeforeAutotable)r.onBeforeAutotable(n(this),r.columns,r.rows,t);if(r.doc.autoTable(r.columns,r.rows,t),"function"==typeof r.onAfterAutotable)r.onAfterAutotable(n(this),t);i.jspdf.autotable.startY=r.doc.autoTableEndPosY()+t.margin.top});yi(r.doc,"undefined"!=typeof r.images&&!1===jQuery.isEmptyObject(r.images));"undefined"!=typeof r.headerrows&&(r.headerrows.length=0);"undefined"!=typeof r.columns&&(r.columns.length=0);"undefined"!=typeof r.rows&&(r.rows.length=0);delete r.doc;r.doc=null})}return this}}(jQuery);