(function(n){var tt,it,rt,ut,ft,et,h,o={},c={},l={},ot={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{isParent:"isParent",children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",headers:{},xhrFields:{},url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},a=[function(n){var t=n.treeObj,r=i.event;t.bind(r.NODECREATED,function(t,i,r){u.apply(n.callback.onNodeCreated,[t,i,r])});t.bind(r.CLICK,function(t,i,r,f,e){u.apply(n.callback.onClick,[i,r,f,e])});t.bind(r.EXPAND,function(t,i,r){u.apply(n.callback.onExpand,[t,i,r])});t.bind(r.COLLAPSE,function(t,i,r){u.apply(n.callback.onCollapse,[t,i,r])});t.bind(r.ASYNC_SUCCESS,function(t,i,r,f){u.apply(n.callback.onAsyncSuccess,[t,i,r,f])});t.bind(r.ASYNC_ERROR,function(t,i,r,f,e,o){u.apply(n.callback.onAsyncError,[t,i,r,f,e,o])});t.bind(r.REMOVE,function(t,i,r){u.apply(n.callback.onRemove,[t,i,r])});t.bind(r.SELECTED,function(t,i,r){u.apply(n.callback.onSelected,[i,r])});t.bind(r.UNSELECTED,function(t,i,r){u.apply(n.callback.onUnSelected,[i,r])})}],v=[function(n){var t=i.event;n.treeObj.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)}],y=[function(n){var i=t.getCache(n);i||(i={},t.setCache(n,i));i.nodes=[];i.doms=[]}],p=[function(n,i,r,f,e,o){if(r){var s=t.getRoot(n),h=t.nodeChildren(n,r);r.level=i;r.tId=n.treeId+"_"+ ++s.zId;r.parentTId=f?f.tId:null;r.open=typeof r.open=="string"?u.eqs(r.open,"true"):!!r.open;i=t.nodeIsParent(n,r);u.isArray(h)?(t.nodeIsParent(n,r,!0),r.zAsync=!0):(i=t.nodeIsParent(n,r,i),r.open=i&&!n.async.enable?r.open:!1,r.zAsync=!i);r.isFirstNode=e;r.isLastNode=o;r.getParentNode=function(){return t.getNodeCache(n,r.parentTId)};r.getPreNode=function(){return t.getPreNode(n,r)};r.getNextNode=function(){return t.getNextNode(n,r)};r.getIndex=function(){return t.getNodeIndex(n,r)};r.getPath=function(){return t.getNodePath(n,r)};r.isAjaxing=!1;t.fixPIdKeyValue(n,r)}}],s=[function(n){var s=n.target,r=t.getSetting(n.data.treeId),f="",l=null,e="",o="",a=null,c=null,h=null;if(u.eqs(n.type,"mousedown")?o="mousedown":u.eqs(n.type,"mouseup")?o="mouseup":u.eqs(n.type,"contextmenu")?o="contextmenu":u.eqs(n.type,"click")?u.eqs(s.tagName,"span")&&s.getAttribute("treeNode"+i.id.SWITCH)!==null?(f=u.getNodeMainDom(s).id,e="switchNode"):(h=u.getMDom(r,s,[{tagName:"a",attrName:"treeNode"+i.id.A}]))&&(f=u.getNodeMainDom(h).id,e="clickNode"):u.eqs(n.type,"dblclick")&&(o="dblclick",h=u.getMDom(r,s,[{tagName:"a",attrName:"treeNode"+i.id.A}]))&&(f=u.getNodeMainDom(h).id,e="switchNode"),o.length>0&&f.length==0&&(h=u.getMDom(r,s,[{tagName:"a",attrName:"treeNode"+i.id.A}]))&&(f=u.getNodeMainDom(h).id),f.length>0)switch(l=t.getNodeCache(r,f),e){case"switchNode":t.nodeIsParent(r,l)?u.eqs(n.type,"click")||u.eqs(n.type,"dblclick")&&u.apply(r.view.dblClickExpand,[r.treeId,l],r.view.dblClickExpand)?a=tt:e="":e="";break;case"clickNode":a=it}switch(o){case"mousedown":c=rt;break;case"mouseup":c=ut;break;case"dblclick":c=ft;break;case"contextmenu":c=et}return{stop:!1,node:l,nodeEventType:e,nodeEventCallback:a,treeEventType:o,treeEventCallback:c}}],w=[function(n){var i=t.getRoot(n);i||(i={},t.setRoot(n,i));t.nodeChildren(n,i,[]);i.expandTriggerFlag=!1;i.curSelectedList=[];i.noSelection=!0;i.createdNodes=[];i.zId=0;i._ver=(new Date).getTime()}],b=[],k=[],d=[],g=[],nt=[],t={addNodeCache:function(n,i){t.getCache(n).nodes[t.getNodeCacheId(i.tId)]=i},getNodeCacheId:function(n){return n.substring(n.lastIndexOf("_")+1)},addAfterA:function(n){k.push(n)},addBeforeA:function(n){b.push(n)},addInnerAfterA:function(n){g.push(n)},addInnerBeforeA:function(n){d.push(n)},addInitBind:function(n){a.push(n)},addInitUnBind:function(n){v.push(n)},addInitCache:function(n){y.push(n)},addInitNode:function(n){p.push(n)},addInitProxy:function(n,t){t?s.splice(0,0,n):s.push(n)},addInitRoot:function(n){w.push(n)},addNodesData:function(n,i,u,f){var e=t.nodeChildren(n,i);e?u>=e.length&&(u=-1):(e=t.nodeChildren(n,i,[]),u=-1);e.length>0&&u===0?(e[0].isFirstNode=!1,r.setNodeLineIcos(n,e[0])):e.length>0&&u<0&&(e[e.length-1].isLastNode=!1,r.setNodeLineIcos(n,e[e.length-1]));t.nodeIsParent(n,i,!0);u<0?t.nodeChildren(n,i,e.concat(f)):(n=[u,0].concat(f),e.splice.apply(e,n))},addSelectedNode:function(n,i){var r=t.getRoot(n);t.isSelectedNode(n,i)||r.curSelectedList.push(i)},addCreatedNode:function(n,i){(n.callback.onNodeCreated||n.view.addDiyDom)&&t.getRoot(n).createdNodes.push(i)},addZTreeTools:function(n){nt.push(n)},exSetting:function(t){n.extend(!0,ot,t)},fixPIdKeyValue:function(n,t){n.data.simpleData.enable&&(t[n.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[n.data.simpleData.idKey]:n.data.simpleData.rootPId)},getAfterA:function(){for(var n=0,t=k.length;n<t;n++)k[n].apply(this,arguments)},getBeforeA:function(){for(var n=0,t=b.length;n<t;n++)b[n].apply(this,arguments)},getInnerAfterA:function(){for(var n=0,t=g.length;n<t;n++)g[n].apply(this,arguments)},getInnerBeforeA:function(){for(var n=0,t=d.length;n<t;n++)d[n].apply(this,arguments)},getCache:function(n){return l[n.treeId]},getNodeIndex:function(n,i){if(!i)return null;for(var u=i.parentTId?i.getParentNode():t.getRoot(n),u=t.nodeChildren(n,u),r=0,f=u.length-1;r<=f;r++)if(u[r]===i)return r;return-1},getNextNode:function(n,i){if(!i)return null;for(var u=i.parentTId?i.getParentNode():t.getRoot(n),u=t.nodeChildren(n,u),r=0,f=u.length-1;r<=f;r++)if(u[r]===i)return r==f?null:u[r+1];return null},getNodeByParam:function(n,i,r,u){var e,o,f;if(!i||!r)return null;for(e=0,o=i.length;e<o;e++){if(f=i[e],f[r]==u)return i[e];if(f=t.nodeChildren(n,f),f=t.getNodeByParam(n,f,r,u))return f}return null},getNodeCache:function(n,i){if(!i)return null;var r=l[n.treeId].nodes[t.getNodeCacheId(i)];return r?r:null},getNodePath:function(n,t){if(!t)return null;var i;return(i=t.parentTId?t.getParentNode().getPath():[])&&i.push(t),i},getNodes:function(n){return t.nodeChildren(n,t.getRoot(n))},getNodesByParam:function(n,i,r,u){var f;if(!i||!r)return[];for(var e=[],o=0,s=i.length;o<s;o++)f=i[o],f[r]==u&&e.push(f),f=t.nodeChildren(n,f),e=e.concat(t.getNodesByParam(n,f,r,u));return e},getNodesByParamFuzzy:function(n,i,r,u){var f;if(!i||!r)return[];for(var e=[],u=u.toLowerCase(),o=0,s=i.length;o<s;o++)f=i[o],typeof f[r]=="string"&&i[o][r].toLowerCase().indexOf(u)>-1&&e.push(f),f=t.nodeChildren(n,f),e=e.concat(t.getNodesByParamFuzzy(n,f,r,u));return e},getNodesByFilter:function(n,i,r,f,e){var o;if(!i)return f?null:[];for(var s=f?null:[],h=0,c=i.length;h<c;h++){if(o=i[h],u.apply(r,[o,e],!1)){if(f)return o;s.push(o)}if(o=t.nodeChildren(n,o),o=t.getNodesByFilter(n,o,r,f,e),f&&o)return o;s=f?o:s.concat(o)}return s},getPreNode:function(n,i){if(!i)return null;for(var u=i.parentTId?i.getParentNode():t.getRoot(n),u=t.nodeChildren(n,u),r=0,f=u.length;r<f;r++)if(u[r]===i)return r==0?null:u[r-1];return null},getRoot:function(n){return n?c[n.treeId]:null},getRoots:function(){return c},getSetting:function(n){return o[n]},getSettings:function(){return o},getZTreeTools:function(n){return(n=this.getRoot(this.getSetting(n)))?n.treeTools:null},initCache:function(){for(var n=0,t=y.length;n<t;n++)y[n].apply(this,arguments)},initNode:function(){for(var n=0,t=p.length;n<t;n++)p[n].apply(this,arguments)},initRoot:function(){for(var n=0,t=w.length;n<t;n++)w[n].apply(this,arguments)},isSelectedNode:function(n,i){for(var u=t.getRoot(n),r=0,f=u.curSelectedList.length;r<f;r++)if(i===u.curSelectedList[r])return!0;return!1},nodeChildren:function(n,t,i){return t?(n=n.data.key.children,typeof i!="undefined"&&(t[n]=i),t[n]):null},nodeIsParent:function(n,t,i){return t?(n=n.data.key.isParent,typeof i!="undefined"?(typeof i=="string"&&(i=u.eqs(i,"true")),t[n]=!!i):t[n]=typeof t[n]=="string"?u.eqs(t[n],"true"):!!t[n],t[n]):!1},nodeName:function(n,t,i){return n=n.data.key.name,typeof i!="undefined"&&(t[n]=i),""+t[n]},nodeTitle:function(n,t){return""+t[n.data.key.title===""?n.data.key.name:n.data.key.title]},removeNodeCache:function(n,i){var u=t.nodeChildren(n,i),r,f;if(u)for(r=0,f=u.length;r<f;r++)t.removeNodeCache(n,u[r]);t.getCache(n).nodes[t.getNodeCacheId(i.tId)]=null},removeSelectedNode:function(n,r){for(var f=t.getRoot(n),u=0,e=f.curSelectedList.length;u<e;u++)r!==f.curSelectedList[u]&&t.getNodeCache(n,f.curSelectedList[u].tId)||(f.curSelectedList.splice(u,1),n.treeObj.trigger(i.event.UNSELECTED,[n.treeId,r]),u--,e--)},setCache:function(n,t){l[n.treeId]=t},setRoot:function(n,t){c[n.treeId]=t},setZTreeTools:function(){for(var n=0,t=nt.length;n<t;n++)nt[n].apply(this,arguments)},transformToArrayFormat:function(n,i){function e(i){r.push(i);(i=t.nodeChildren(n,i))&&(r=r.concat(t.transformToArrayFormat(n,i)))}var r,f,o;if(!i)return[];if(r=[],u.isArray(i))for(f=0,o=i.length;f<o;f++)e(i[f]);else e(i);return r},transformTozTreeFormat:function(n,i){var r,f,e=n.data.simpleData.idKey,l=n.data.simpleData.pIdKey,h,c,o,s;if(!e||e==""||!i)return[];if(u.isArray(i)){for(h=[],c={},r=0,f=i.length;r<f;r++)c[i[r][e]]=i[r];for(r=0,f=i.length;r<f;r++)o=c[i[r][l]],o&&i[r][e]!=i[r][l]?(s=t.nodeChildren(n,o),s||(s=t.nodeChildren(n,o,[])),s.push(i[r])):h.push(i[r]);return h}return[i]}},e={bindEvent:function(){for(var n=0,t=a.length;n<t;n++)a[n].apply(this,arguments)},unbindEvent:function(){for(var n=0,t=v.length;n<t;n++)v[n].apply(this,arguments)},bindTree:function(n){var i={treeId:n.treeId},t=n.treeObj;n.view.txtSelectedEnable||t.bind("selectstart",h).css({"-moz-user-select":"-moz-none"});t.bind("click",i,e.proxy);t.bind("dblclick",i,e.proxy);t.bind("mouseover",i,e.proxy);t.bind("mouseout",i,e.proxy);t.bind("mousedown",i,e.proxy);t.bind("mouseup",i,e.proxy);t.bind("contextmenu",i,e.proxy)},unbindTree:function(n){n.treeObj.unbind("selectstart",h).unbind("click",e.proxy).unbind("dblclick",e.proxy).unbind("mouseover",e.proxy).unbind("mouseout",e.proxy).unbind("mousedown",e.proxy).unbind("mouseup",e.proxy).unbind("contextmenu",e.proxy)},doProxy:function(){for(var t,i=[],n=0,r=s.length;n<r;n++)if(t=s[n].apply(this,arguments),i.push(t),t.stop)break;return i},proxy:function(n){var f=t.getSetting(n.data.treeId),i;if(!u.uCanDo(f,n))return!0;for(var f=e.doProxy(n),r=!0,o=0,s=f.length;o<s;o++)i=f[o],i.nodeEventCallback&&(r=i.nodeEventCallback.apply(i,[n,i.node])&&r),i.treeEventCallback&&(r=i.treeEventCallback.apply(i,[n,i.node])&&r);return r}},u,r;tt=function(n,i){var f=t.getSetting(n.data.treeId);if(i.open){if(u.apply(f.callback.beforeCollapse,[f.treeId,i],!0)==!1)return!0}else if(u.apply(f.callback.beforeExpand,[f.treeId,i],!0)==!1)return!0;return t.getRoot(f).expandTriggerFlag=!0,r.switchNode(f,i),!0};it=function(n,f){var e=t.getSetting(n.data.treeId),o=e.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&t.isSelectedNode(e,f)?0:e.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&e.view.selectedMulti?2:1;return u.apply(e.callback.beforeClick,[e.treeId,f,o],!0)==!1?!0:(o===0?r.cancelPreSelectedNode(e,f):r.selectNode(e,f,o===2),e.treeObj.trigger(i.event.CLICK,[n,e.treeId,f,o]),!0)};rt=function(n,i){var r=t.getSetting(n.data.treeId);return u.apply(r.callback.beforeMouseDown,[r.treeId,i],!0)&&u.apply(r.callback.onMouseDown,[n,r.treeId,i]),!0};ut=function(n,i){var r=t.getSetting(n.data.treeId);return u.apply(r.callback.beforeMouseUp,[r.treeId,i],!0)&&u.apply(r.callback.onMouseUp,[n,r.treeId,i]),!0};ft=function(n,i){var r=t.getSetting(n.data.treeId);return u.apply(r.callback.beforeDblClick,[r.treeId,i],!0)&&u.apply(r.callback.onDblClick,[n,r.treeId,i]),!0};et=function(n,i){var r=t.getSetting(n.data.treeId);return u.apply(r.callback.beforeRightClick,[r.treeId,i],!0)&&u.apply(r.callback.onRightClick,[n,r.treeId,i]),typeof r.callback.onRightClick!="function"};h=function(n){return n=n.originalEvent.srcElement.nodeName.toLowerCase(),n==="input"||n==="textarea"};u={apply:function(n,t,i){return typeof n=="function"?n.apply(st,t?t:[]):i},canAsync:function(n,i){var r=t.nodeChildren(n,i),u=t.nodeIsParent(n,i);return n.async.enable&&i&&u&&!(i.zAsync||r&&r.length>0)},clone:function(n){if(n===null)return null;var i=u.isArray(n)?[]:{};for(var t in n)i[t]=n[t]instanceof Date?new Date(n[t].getTime()):typeof n[t]=="object"?u.clone(n[t]):n[t];return i},eqs:function(n,t){return n.toLowerCase()===t.toLowerCase()},isArray:function(n){return Object.prototype.toString.apply(n)==="[object Array]"},isElement:function(n){return typeof HTMLElement=="object"?n instanceof HTMLElement:n&&typeof n=="object"&&n!==null&&n.nodeType===1&&typeof n.nodeName=="string"},$:function(t,i,r){return i&&typeof i!="string"&&(r=i,i=""),typeof t=="string"?n(t,r?r.treeObj.get(0).ownerDocument:null):n("#"+t.tId+i,r?r.treeObj:null)},getMDom:function(n,t,i){if(!t)return null;for(;t&&t.id!==n.treeId;){for(var r=0,f=i.length;t.tagName&&r<f;r++)if(u.eqs(t.tagName,i[r].tagName)&&t.getAttribute(i[r].attrName)!==null)return t;t=t.parentNode}return null},getNodeMainDom:function(t){return n(t).parent("li").get(0)||n(t).parentsUntil("li").parent().get(0)},isChildOrSelf:function(t,i){return n(t).closest("#"+i).length>0},uCanDo:function(){return!0}};r={addNodes:function(n,e,o,s,h){var c=t.nodeIsParent(n,e);if(!n.data.keep.leaf||!e||c)if(u.isArray(s)||(s=[s]),n.data.simpleData.enable&&(s=t.transformTozTreeFormat(n,s)),e){var c=f(e,i.id.SWITCH,n),l=f(e,i.id.ICON,n),a=f(e,i.id.UL,n);e.open||(r.replaceSwitchClass(e,c,i.folder.CLOSE),r.replaceIcoClass(e,l,i.folder.CLOSE),e.open=!1,a.css({display:"none"}));t.addNodesData(n,e,o,s);r.createNodes(n,e.level+1,s,e,o);h||r.expandCollapseParentNode(n,e,!0)}else t.addNodesData(n,t.getRoot(n),o,s),r.createNodes(n,0,s,null,o)},appendNodes:function(n,i,u,f,e,o,s){var l,w,h,p;if(!u)return[];var c=[],v=f?f:t.getRoot(n),v=t.nodeChildren(n,v),y,a;for((!v||e>=v.length-u.length)&&(e=-1),l=0,w=u.length;l<w;l++)h=u[l],o&&(y=(e===0||v.length==u.length)&&l==0,a=e<0&&l==u.length-1,t.initNode(n,i,h,f,y,a,s),t.addNodeCache(n,h)),y=t.nodeIsParent(n,h),a=[],p=t.nodeChildren(n,h),p&&p.length>0&&(a=r.appendNodes(n,i+1,p,h,-1,o,s&&h.open)),s&&(r.makeDOMNodeMainBefore(c,n,h),r.makeDOMNodeLine(c,n,h),t.getBeforeA(n,h,c),r.makeDOMNodeNameBefore(c,n,h),t.getInnerBeforeA(n,h,c),r.makeDOMNodeIcon(c,n,h),t.getInnerAfterA(n,h,c),r.makeDOMNodeNameAfter(c,n,h),t.getAfterA(n,h,c),y&&h.open&&r.makeUlHtml(n,h,c,a.join("")),r.makeDOMNodeMainAfter(c,n,h),t.addCreatedNode(n,h));return c},appendParentULDom:function(n,u){var s=[],o=f(u,n),e;!o.get(0)&&u.parentTId&&(r.appendParentULDom(n,u.getParentNode()),o=f(u,n));e=f(u,i.id.UL,n);e.get(0)&&e.remove();e=t.nodeChildren(n,u);e=r.appendNodes(n,u.level+1,e,u,-1,!1,!0);r.makeUlHtml(n,u,s,e.join(""));o.append(s.join(""))},asyncNode:function(e,o,s,h){var c,y,v,l,a,p,w,b;if(c=t.nodeIsParent(e,o),o&&!c)return u.apply(h),!1;if(o&&o.isAjaxing)return!1;if(u.apply(e.callback.beforeAsync,[e.treeId,o],!0)==!1)return u.apply(h),!1;for(o&&(o.isAjaxing=!0,f(o,i.id.ICON,e).attr({style:"","class":i.className.BUTTON+" "+i.className.ICO_LOADING})),v={},l=u.apply(e.async.autoParam,[e.treeId,o],e.async.autoParam),c=0,y=l.length;o&&c<y;c++)a=l[c].split("="),p=a,a.length>1&&(p=a[1],a=a[0]),v[p]=o[a];if(l=u.apply(e.async.otherParam,[e.treeId,o],e.async.otherParam),u.isArray(l))for(c=0,y=l.length;c<y;c+=2)v[l[c]]=l[c+1];else for(w in l)v[w]=l[w];return b=t.getRoot(e)._ver,n.ajax({contentType:e.async.contentType,cache:!1,type:e.async.type,url:u.apply(e.async.url,[e.treeId,o],e.async.url),data:e.async.contentType.indexOf("application/json")>-1?JSON.stringify(v):v,dataType:e.async.dataType,headers:e.async.headers,xhrFields:e.async.xhrFields,success:function(n){if(b==t.getRoot(e)._ver){var f=[];try{f=!n||n.length==0?[]:typeof n=="string"?eval("("+n+")"):n}catch(c){f=n}o&&(o.isAjaxing=null,o.zAsync=!0);r.setNodeLineIcos(e,o);f&&f!==""?(f=u.apply(e.async.dataFilter,[e.treeId,o,f],f),r.addNodes(e,o,-1,f?u.clone(f):[],!!s)):r.addNodes(e,o,-1,[],!!s);e.treeObj.trigger(i.event.ASYNC_SUCCESS,[e.treeId,o,n]);u.apply(h)}},error:function(n,u,f){b==t.getRoot(e)._ver&&(o&&(o.isAjaxing=null),r.setNodeLineIcos(e,o),e.treeObj.trigger(i.event.ASYNC_ERROR,[e.treeId,o,n,u,f]))}}),!0},cancelPreSelectedNode:function(n,r,u){for(var s=t.getRoot(n).curSelectedList,o,e=s.length-1;e>=0;e--)if(o=s[e],r===o||!r&&(!u||u!==o))if(f(o,i.id.A,n).removeClass(i.node.CURSELECTED),r){t.removeSelectedNode(n,r);break}else s.splice(e,1),n.treeObj.trigger(i.event.UNSELECTED,[n.treeId,o])},createNodeCallback:function(n){var r,f;if(n.callback.onNodeCreated||n.view.addDiyDom)for(r=t.getRoot(n);r.createdNodes.length>0;)f=r.createdNodes.shift(),u.apply(n.view.addDiyDom,[n.treeId,f]),n.callback.onNodeCreated&&n.treeObj.trigger(i.event.NODECREATED,[n.treeId,f])},createNodes:function(u,e,o,s,h){var a,v,e,c,l;o&&o.length!=0&&(a=t.getRoot(u),v=!s||s.open||!!f(t.nodeChildren(u,s)[0],u).get(0),a.createdNodes=[],e=r.appendNodes(u,e,o,s,h,!0,v),s?(s=f(s,i.id.UL,u),s.get(0)&&(c=s)):c=u.treeObj,c&&(h>=0&&(l=c.children()[h]),h>=0&&l?n(l).before(e.join("")):c.append(e.join(""))),r.createNodeCallback(u))},destroy:function(n){n&&(t.initCache(n),t.initRoot(n),e.unbindTree(n),e.unbindEvent(n),n.treeObj.empty(),delete o[n.treeId])},expandCollapseNode:function(n,e,o,s,h){var l=t.getRoot(n),a,c,v;if(e)if(c=t.nodeChildren(n,e),v=t.nodeIsParent(n,e),l.expandTriggerFlag&&(a=h,h=function(){a&&a();e.open?n.treeObj.trigger(i.event.EXPAND,[n.treeId,e]):n.treeObj.trigger(i.event.COLLAPSE,[n.treeId,e])},l.expandTriggerFlag=!1),!e.open&&v&&(!f(e,i.id.UL,n).get(0)||c&&c.length>0&&!f(c[0],n).get(0))&&(r.appendParentULDom(n,e),r.createNodeCallback(n)),e.open==o)u.apply(h,[]);else{var o=f(e,i.id.UL,n),l=f(e,i.id.SWITCH,n),y=f(e,i.id.ICON,n);v?(e.open=!e.open,e.iconOpen&&e.iconClose&&y.attr("style",r.makeNodeIcoStyle(n,e)),e.open?(r.replaceSwitchClass(e,l,i.folder.OPEN),r.replaceIcoClass(e,y,i.folder.OPEN),s==!1||n.view.expandSpeed==""?(o.show(),u.apply(h,[])):c&&c.length>0?o.slideDown(n.view.expandSpeed,h):(o.show(),u.apply(h,[]))):(r.replaceSwitchClass(e,l,i.folder.CLOSE),r.replaceIcoClass(e,y,i.folder.CLOSE),s==!1||n.view.expandSpeed==""||!(c&&c.length>0)?(o.hide(),u.apply(h,[])):o.slideUp(n.view.expandSpeed,h))):u.apply(h,[])}else u.apply(h,[])},expandCollapseParentNode:function(n,t,i,u,f){t&&(t.parentTId?(r.expandCollapseNode(n,t,i,u),t.parentTId&&r.expandCollapseParentNode(n,t.getParentNode(),i,u,f)):r.expandCollapseNode(n,t,i,u,f))},expandCollapseSonNode:function(n,i,u,f,e){var o=t.getRoot(n),o=i?t.nodeChildren(n,i):t.nodeChildren(n,o),c=i?!1:f,l=t.getRoot(n).expandTriggerFlag,s,h;if(t.getRoot(n).expandTriggerFlag=!1,o)for(s=0,h=o.length;s<h;s++)o[s]&&r.expandCollapseSonNode(n,o[s],u,c);t.getRoot(n).expandTriggerFlag=l;r.expandCollapseNode(n,i,u,f,e)},isSelectedNode:function(n,i){if(!i)return!1;for(var u=t.getRoot(n).curSelectedList,r=u.length-1;r>=0;r--)if(i===u[r])return!0;return!1},makeDOMNodeIcon:function(n,u,f){var e=t.nodeName(u,f),e=u.view.nameIsHTML?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push("<span id='",f.tId,i.id.ICON,"' title='' treeNode",i.id.ICON," class='",r.makeNodeIcoClass(u,f),"' style='",r.makeNodeIcoStyle(u,f),"'><\/span><span id='",f.tId,i.id.SPAN,"' class='",i.className.NAME,"'>",e,"<\/span>")},makeDOMNodeLine:function(n,t,u){n.push("<span id='",u.tId,i.id.SWITCH,"' title='' class='",r.makeNodeLineClass(t,u),"' treeNode",i.id.SWITCH,"><\/span>")},makeDOMNodeMainAfter:function(n){n.push("<\/li>")},makeDOMNodeMainBefore:function(n,t,r){n.push("<li id='",r.tId,"' class='",i.className.LEVEL,r.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(n){n.push("<\/a>")},makeDOMNodeNameBefore:function(n,f,e){var s=t.nodeTitle(f,e),o=r.makeNodeUrl(f,e),h=r.makeNodeFontCss(f,e),c=[];for(var l in h)c.push(l,":",h[l],";");n.push("<a id='",e.tId,i.id.A,"' class='",i.className.LEVEL,e.level,"' treeNode",i.id.A,' onclick="',e.click||"",'" ',o!=null&&o.length>0?"href='"+o+"'":""," target='",r.makeNodeTarget(e),"' style='",c.join(""),"'");u.apply(f.view.showTitle,[f.treeId,e],f.view.showTitle)&&s&&n.push("title='",s.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");n.push(">")},makeNodeFontCss:function(n,t){var i=u.apply(n.view.fontCss,[n.treeId,t],n.view.fontCss);return i&&typeof i!="function"?i:{}},makeNodeIcoClass:function(n,r){var u=["ico"],f;return r.isAjaxing||(f=t.nodeIsParent(n,r),u[0]=(r.iconSkin?r.iconSkin+"_":"")+u[0],f?u.push(r.open?i.folder.OPEN:i.folder.CLOSE):u.push(i.folder.DOCU)),i.className.BUTTON+" "+u.join("_")},makeNodeIcoStyle:function(n,i){var r=[],f;return i.isAjaxing||(f=t.nodeIsParent(n,i)&&i.iconOpen&&i.iconClose?i.open?i.iconOpen:i.iconClose:i[n.data.key.icon],f&&r.push("background:url(",f,") 0 0 no-repeat;"),n.view.showIcon!=!1&&u.apply(n.view.showIcon,[n.treeId,i],!0)||r.push("width:0px;height:0px;")),r.join("")},makeNodeLineClass:function(n,u){var f=[];return n.view.showLine?u.level==0&&u.isFirstNode&&u.isLastNode?f.push(i.line.ROOT):u.level==0&&u.isFirstNode?f.push(i.line.ROOTS):u.isLastNode?f.push(i.line.BOTTOM):f.push(i.line.CENTER):f.push(i.line.NOLINE),t.nodeIsParent(n,u)?f.push(u.open?i.folder.OPEN:i.folder.CLOSE):f.push(i.folder.DOCU),r.makeNodeLineClassEx(u)+f.join("_")},makeNodeLineClassEx:function(n){return i.className.BUTTON+" "+i.className.LEVEL+n.level+" "+i.className.SWITCH+" "},makeNodeTarget:function(n){return n.target||"_blank"},makeNodeUrl:function(n,t){var i=n.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(n,t,u,f){u.push("<ul id='",t.tId,i.id.UL,"' class='",i.className.LEVEL,t.level," ",r.makeUlLineClass(n,t),"' style='display:",t.open?"block":"none","'>");u.push(f);u.push("<\/ul>")},makeUlLineClass:function(n,t){return n.view.showLine&&!t.isLastNode?i.line.LINE:""},removeChildNodes:function(n,u){var e,o,s;if(u&&(e=t.nodeChildren(n,u),e)){for(o=0,s=e.length;o<s;o++)t.removeNodeCache(n,e[o]);t.removeSelectedNode(n);delete u[n.data.key.children];n.data.keep.parent?f(u,i.id.UL,n).empty():(t.nodeIsParent(n,u,!1),u.open=!1,e=f(u,i.id.SWITCH,n),o=f(u,i.id.ICON,n),r.replaceSwitchClass(u,e,i.folder.DOCU),r.replaceIcoClass(u,o,i.folder.DOCU),f(u,i.id.UL,n).remove())}},scrollIntoView:function(n,t){if(t)if(typeof Element=="undefined"){var i=n.treeObj.get(0).getBoundingClientRect(),r=t.getBoundingClientRect();(r.top<i.top||r.bottom>i.bottom||r.right>i.right||r.left<i.left)&&t.scrollIntoView()}else Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(n){function i(n,t){return{start:n,length:t,end:n+t}}function e(t,i){return!1===n||i.start<t.end&&t.start<i.end?Math.max(t.end-i.length,Math.min(i.start,t.start)):(t.start+t.end-i.length)/2}function r(n,t){return{x:n,y:t,translate:function(i,u){return r(n+i,t+u)}}}function o(n,t){for(;n;)t=t.translate(n.offsetLeft,n.offsetTop),n=n.offsetParent;return t}for(var u=o(this,r(0,0)),s=r(this.offsetWidth,this.offsetHeight),t=this.parentNode,f;t instanceof HTMLElement;)f=o(t,r(t.clientLeft,t.clientTop)),t.scrollLeft=e(i(u.x-f.x,s.x),i(t.scrollLeft,t.clientWidth)),t.scrollTop=e(i(u.y-f.y,s.y),i(t.scrollTop,t.clientHeight)),u=u.translate(-t.scrollLeft,-t.scrollTop),t=t.parentNode}),t.scrollIntoViewIfNeeded()},setFirstNode:function(n,i){var r=t.nodeChildren(n,i);r.length>0&&(r[0].isFirstNode=!0)},setLastNode:function(n,i){var r=t.nodeChildren(n,i);r.length>0&&(r[r.length-1].isLastNode=!0)},removeNode:function(n,u){var l=t.getRoot(n),e=u.parentTId?u.getParentNode():l,a,o;if(u.isFirstNode=!1,u.isLastNode=!1,u.getPreNode=function(){return null},u.getNextNode=function(){return null},t.getNodeCache(n,u.tId)){f(u,n).remove();t.removeNodeCache(n,u);t.removeSelectedNode(n,u);for(var s=t.nodeChildren(n,e),o=0,h=s.length;o<h;o++)if(s[o].tId==u.tId){s.splice(o,1);break}if(r.setFirstNode(n,e),r.setLastNode(n,e),o=s.length,n.data.keep.parent||o!=0){if(n.view.showLine&&o>0){var c=s[o-1],o=f(c,i.id.UL,n),h=f(c,i.id.SWITCH,n);a=f(c,i.id.ICON,n);e==l?s.length==1?r.replaceSwitchClass(c,h,i.line.ROOT):(l=f(s[0],i.id.SWITCH,n),r.replaceSwitchClass(s[0],l,i.line.ROOTS),r.replaceSwitchClass(c,h,i.line.BOTTOM)):r.replaceSwitchClass(c,h,i.line.BOTTOM);o.removeClass(i.line.LINE)}}else t.nodeIsParent(n,e,!1),e.open=!1,delete e[n.data.key.children],o=f(e,i.id.UL,n),h=f(e,i.id.SWITCH,n),a=f(e,i.id.ICON,n),r.replaceSwitchClass(e,h,i.folder.DOCU),r.replaceIcoClass(e,a,i.folder.DOCU),o.css("display","none")}},replaceIcoClass:function(n,t,r){if(t&&!n.isAjaxing&&(n=t.attr("class"),n!=void 0)){n=n.split("_");switch(r){case i.folder.OPEN:case i.folder.CLOSE:case i.folder.DOCU:n[n.length-1]=r}t.attr("class",n.join("_"))}},replaceSwitchClass:function(n,t,u){if(t){var f=t.attr("class");if(f!=void 0){f=f.split("_");switch(u){case i.line.ROOT:case i.line.ROOTS:case i.line.CENTER:case i.line.BOTTOM:case i.line.NOLINE:f[0]=r.makeNodeLineClassEx(n)+u;break;case i.folder.OPEN:case i.folder.CLOSE:case i.folder.DOCU:f[1]=u}t.attr("class",f.join("_"));u!==i.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(n,u,e){e||r.cancelPreSelectedNode(n,null,u);f(u,i.id.A,n).addClass(i.node.CURSELECTED);t.addSelectedNode(n,u);n.treeObj.trigger(i.event.SELECTED,[n.treeId,u])},setNodeFontCss:function(n,t){var e=f(t,i.id.A,n),u=r.makeNodeFontCss(n,t);u&&e.css(u)},setNodeLineIcos:function(n,u){if(u){var e=f(u,i.id.SWITCH,n),s=f(u,i.id.UL,n),o=f(u,i.id.ICON,n),h=r.makeUlLineClass(n,u);h.length==0?s.removeClass(i.line.LINE):s.addClass(h);e.attr("class",r.makeNodeLineClass(n,u));t.nodeIsParent(n,u)?e.removeAttr("disabled"):e.attr("disabled","disabled");o.removeAttr("style");o.attr("style",r.makeNodeIcoStyle(n,u));o.attr("class",r.makeNodeIcoClass(n,u))}},setNodeName:function(n,r){var o=t.nodeTitle(n,r),e=f(r,i.id.SPAN,n);e.empty();n.view.nameIsHTML?e.html(t.nodeName(n,r)):e.text(t.nodeName(n,r));u.apply(n.view.showTitle,[n.treeId,r],n.view.showTitle)&&f(r,i.id.A,n).attr("title",o?o:"")},setNodeTarget:function(n,t){f(t,i.id.A,n).attr("target",r.makeNodeTarget(t))},setNodeUrl:function(n,t){var e=f(t,i.id.A,n),u=r.makeNodeUrl(n,t);u==null||u.length==0?e.removeAttr("href"):e.attr("href",u)},switchNode:function(n,t){t.open||!u.canAsync(n,t)?r.expandCollapseNode(n,t,!t.open):n.async.enable?r.asyncNode(n,t)||r.expandCollapseNode(n,t,!t.open):t&&r.expandCollapseNode(n,t,!t.open)}};n.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:u,view:r,event:e,data:t},getZTreeObj:function(n){return(n=t.getZTreeTools(n))?n:null},destroy:function(n){if(n&&n.length>0)r.destroy(t.getSetting(n));else for(var i in o)r.destroy(o[i])},init:function(s,h,c){var l=u.clone(ot),a;return n.extend(!0,l,h),l.treeId=s.attr("id"),l.treeObj=s,l.treeObj.empty(),o[l.treeId]=l,typeof document.body.style.maxHeight=="undefined"&&(l.view.expandSpeed=""),t.initRoot(l),s=t.getRoot(l),c=c?u.clone(u.isArray(c)?c:[c]):[],l.data.simpleData.enable?t.nodeChildren(l,s,t.transformTozTreeFormat(l,c)):t.nodeChildren(l,s,c),t.initCache(l),e.unbindTree(l),e.bindTree(l),e.unbindEvent(l),e.bindEvent(l),a={setting:l,addNodes:function(n,i,f,e){function h(){r.addNodes(l,n,i,s,e==!0)}var o,s;return(n||(n=null),o=t.nodeIsParent(l,n),n&&!o&&l.data.keep.leaf)?null:(o=parseInt(i,10),isNaN(o)?(e=!!f,f=i,i=-1):i=o,!f)?null:(s=u.clone(u.isArray(f)?f:[f]),u.canAsync(l,n)?r.asyncNode(l,n,e,h):h(),s)},cancelSelectedNode:function(n){r.cancelPreSelectedNode(l,n)},destroy:function(){r.destroy(l)},expandAll:function(n){return n=!!n,r.expandCollapseSonNode(l,null,n,!0),n},expandNode:function(n,i,e,o,s){function h(){var t=f(n,l).get(0);t&&o!==!1&&r.scrollIntoView(l,t)}return!n||!t.nodeIsParent(l,n)?null:(i!==!0&&i!==!1&&(i=!n.open),(s=!!s)&&i&&u.apply(l.callback.beforeExpand,[l.treeId,n],!0)==!1)?null:s&&!i&&u.apply(l.callback.beforeCollapse,[l.treeId,n],!0)==!1?null:(i&&n.parentTId&&r.expandCollapseParentNode(l,n.getParentNode(),i,!1),i===n.open&&!e)?null:(t.getRoot(l).expandTriggerFlag=s,!u.canAsync(l,n)&&e?r.expandCollapseSonNode(l,n,i,!0,h):(n.open=!i,r.switchNode(this.setting,n),h()),i)},getNodes:function(){return t.getNodes(l)},getNodeByParam:function(n,i,r){return n?t.getNodeByParam(l,r?t.nodeChildren(l,r):t.getNodes(l),n,i):null},getNodeByTId:function(n){return t.getNodeCache(l,n)},getNodesByParam:function(n,i,r){return n?t.getNodesByParam(l,r?t.nodeChildren(l,r):t.getNodes(l),n,i):null},getNodesByParamFuzzy:function(n,i,r){return n?t.getNodesByParamFuzzy(l,r?t.nodeChildren(l,r):t.getNodes(l),n,i):null},getNodesByFilter:function(n,i,r,u){return i=!!i,!n||typeof n!="function"?i?null:[]:t.getNodesByFilter(l,r?t.nodeChildren(l,r):t.getNodes(l),n,i,u)},getNodeIndex:function(n){if(!n)return null;for(var r=n.parentTId?n.getParentNode():t.getRoot(l),r=t.nodeChildren(l,r),i=0,u=r.length;i<u;i++)if(r[i]==n)return i;return-1},getSelectedNodes:function(){for(var i=[],r=t.getRoot(l).curSelectedList,n=0,u=r.length;n<u;n++)i.push(r[n]);return i},isSelectedNode:function(n){return t.isSelectedNode(l,n)},reAsyncChildNodesPromise:function(n,t,i){return new Promise(function(r,u){try{a.reAsyncChildNodes(n,t,i,function(){r(n)})}catch(f){u(f)}})},reAsyncChildNodes:function(n,u,e,o){var s;if(this.setting.async.enable){if(s=!n,s&&(n=t.getRoot(l)),u=="refresh"){for(var u=t.nodeChildren(l,n),h=0,c=u?u.length:0;h<c;h++)t.removeNodeCache(l,u[h]);t.removeSelectedNode(l);t.nodeChildren(l,n,[]);s?this.setting.treeObj.empty():f(n,i.id.UL,l).empty()}r.asyncNode(this.setting,s?null:n,!!e,o)}},refresh:function(){this.setting.treeObj.empty();var n=t.getRoot(l),i=t.nodeChildren(l,n);t.initRoot(l);t.nodeChildren(l,n,i);t.initCache(l);r.createNodes(l,0,t.nodeChildren(l,n),null,-1)},removeChildNodes:function(n){if(!n)return null;var i=t.nodeChildren(l,n);return r.removeChildNodes(l,n),i?i:null},removeNode:function(n,t){n&&(t=!!t,t&&u.apply(l.callback.beforeRemove,[l.treeId,n],!0)==!1||(r.removeNode(l,n),t&&this.setting.treeObj.trigger(i.event.REMOVE,[l.treeId,n])))},selectNode:function(n,t,i){function e(){if(!i){var t=f(n,l).get(0);r.scrollIntoView(l,t)}}if(n&&u.uCanDo(l)){if(t=l.view.selectedMulti&&t,n.parentTId)r.expandCollapseParentNode(l,n.getParentNode(),!0,!1,e);else if(!i)try{f(n,l).focus().blur()}catch(o){}r.selectNode(l,n,t)}},transformTozTreeNodes:function(n){return t.transformTozTreeFormat(l,n)},transformToArray:function(n){return t.transformToArrayFormat(l,n)},updateNode:function(n){n&&f(n,l).get(0)&&u.uCanDo(l)&&(r.setNodeName(l,n),r.setNodeTarget(l,n),r.setNodeUrl(l,n),r.setNodeLineIcos(l,n),r.setNodeFontCss(l,n))}},s.treeTools=a,t.setZTreeTools(l,a),(c=t.nodeChildren(l,s))&&c.length>0?r.createNodes(l,0,c,null,-1):l.async.enable&&l.async.url&&l.async.url!==""&&r.asyncNode(l),a}};var st=n.fn.zTree,f=u.$,i=st.consts})(jQuery),function(n){var c,l,a,e={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},v={check:{enable:!1,autoCheckTrigger:!1,chkStyle:e.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:e.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},o,s,h;c=function(n,e){var o,s;return e.chkDisabled===!0?!1:(o=t.getSetting(n.data.treeId),u.apply(o.callback.beforeCheck,[o.treeId,e],!0)==!1)?!0:(s=t.nodeChecked(o,e),t.nodeChecked(o,e,!s),i.checkNodeRelation(o,e),s=f(e,r.id.CHECK,o),i.setChkClass(o,s,e),i.repairParentChkClassWithSelf(o,e),o.treeObj.trigger(r.event.CHECK,[n,o.treeId,e]),!0)};l=function(n,u){if(u.chkDisabled===!0)return!1;var e=t.getSetting(n.data.treeId),o=f(u,r.id.CHECK,e);return u.check_Focus=!0,i.setChkClass(e,o,u),!0};a=function(n,u){if(u.chkDisabled===!0)return!1;var e=t.getSetting(n.data.treeId),o=f(u,r.id.CHECK,e);return u.check_Focus=!1,i.setChkClass(e,o,u),!0};n.extend(!0,n.fn.zTree.consts,e);n.extend(!0,n.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(n,u){var e,o,h,s,c;if(o=r.radio,e=t.nodeChecked(n,u),n.check.chkStyle==o.STYLE){if(s=t.getRadioCheckedList(n),e)if(n.check.radioType==o.TYPE_ALL){for(o=s.length-1;o>=0;o--)e=s[o],c=t.nodeChecked(n,e),c&&e!=u&&(t.nodeChecked(n,e,!1),s.splice(o,1),i.setChkClass(n,f(e,r.id.CHECK,n),e),e.parentTId!=u.parentTId&&i.repairParentChkClassWithSelf(n,e));s.push(u)}else for(s=u.parentTId?u.getParentNode():t.getRoot(n),s=t.nodeChildren(n,s),o=0,h=s.length;o<h;o++)(e=s[o],(c=t.nodeChecked(n,e))&&e!=u)&&(t.nodeChecked(n,e,!1),i.setChkClass(n,f(e,r.id.CHECK,n),e));else if(n.check.radioType==o.TYPE_ALL)for(o=0,h=s.length;o<h;o++)if(u==s[o]){s.splice(o,1);break}}else s=t.nodeChildren(n,u),e&&(!s||s.length==0||n.check.chkboxType.Y.indexOf("s")>-1)&&i.setSonNodeCheckBox(n,u,!0),!e&&(!s||s.length==0||n.check.chkboxType.N.indexOf("s")>-1)&&i.setSonNodeCheckBox(n,u,!1),e&&n.check.chkboxType.Y.indexOf("p")>-1&&i.setParentNodeCheckBox(n,u,!0),!e&&n.check.chkboxType.N.indexOf("p")>-1&&i.setParentNodeCheckBox(n,u,!1)},makeChkClass:function(n,i){var u=r.checkbox,f=r.radio,o="",e=t.nodeChecked(n,i),o=i.chkDisabled===!0?u.DISABLED:i.halfCheck?u.PART:n.check.chkStyle==f.STYLE?i.check_Child_State<1?u.FULL:u.PART:e?i.check_Child_State===2||i.check_Child_State===-1?u.FULL:u.PART:i.check_Child_State<1?u.FULL:u.PART,f=n.check.chkStyle+"_"+(e?u.TRUE:u.FALSE)+"_"+o,f=i.check_Focus&&i.chkDisabled!==!0?f+"_"+u.FOCUS:f;return r.className.BUTTON+" "+u.DEFAULT+" "+f},repairAllChk:function(n,u){var f;if(n.check.enable&&n.check.chkStyle===r.checkbox.STYLE)for(var e=t.getRoot(n),e=t.nodeChildren(n,e),o=0,s=e.length;o<s;o++)f=e[o],f.nocheck!==!0&&f.chkDisabled!==!0&&t.nodeChecked(n,f,u),i.setSonNodeCheckBox(n,f,u)},repairChkClass:function(n,u){if(u&&(t.makeChkFlag(n,u),u.nocheck!==!0)){var e=f(u,r.id.CHECK,n);i.setChkClass(n,e,u)}},repairParentChkClass:function(n,t){if(t&&t.parentTId){var r=t.getParentNode();i.repairChkClass(n,r);i.repairParentChkClass(n,r)}},repairParentChkClassWithSelf:function(n,r){if(r){var u=t.nodeChildren(n,r);u&&u.length>0?i.repairParentChkClass(n,u[0]):i.repairParentChkClass(n,r)}},repairSonChkDisabled:function(n,r,u,f){if(r&&(r.chkDisabled!=u&&(r.chkDisabled=u),i.repairChkClass(n,r),(r=t.nodeChildren(n,r))&&f))for(var e=0,o=r.length;e<o;e++)i.repairSonChkDisabled(n,r[e],u,f)},repairParentChkDisabled:function(n,t,r,u){t&&(t.chkDisabled!=r&&u&&(t.chkDisabled=r),i.repairChkClass(n,t),i.repairParentChkDisabled(n,t.getParentNode(),r,u))},setChkClass:function(n,t,r){t&&(r.nocheck===!0?t.hide():t.show(),t.attr("class",i.makeChkClass(n,r)))},setParentNodeCheckBox:function(n,u,e,o){var h=f(u,r.id.CHECK,n),s,a;if(o||(o=u),t.makeChkFlag(n,u),u.nocheck!==!0&&u.chkDisabled!==!0&&(t.nodeChecked(n,u,e),i.setChkClass(n,h,u),n.check.autoCheckTrigger&&u!=o&&n.treeObj.trigger(r.event.CHECK,[null,n.treeId,u])),u.parentTId){if(h=!0,!e)for(var l=t.nodeChildren(n,u.getParentNode()),c=0,v=l.length;c<v;c++)if(s=l[c],a=t.nodeChecked(n,s),s.nocheck!==!0&&s.chkDisabled!==!0&&a||(s.nocheck===!0||s.chkDisabled===!0)&&s.check_Child_State>0){h=!1;break}h&&i.setParentNodeCheckBox(n,u.getParentNode(),e,o)}},setSonNodeCheckBox:function(n,u,e,o){var a,h,s,c,v,l;if(u){if(a=f(u,r.id.CHECK,n),o||(o=u),h=!1,s=t.nodeChildren(n,u),s)for(c=0,v=s.length;c<v;c++)l=s[c],i.setSonNodeCheckBox(n,l,e,o),l.chkDisabled===!0&&(h=!0);u!=t.getRoot(n)&&u.chkDisabled!==!0&&(h&&u.nocheck!==!0&&t.makeChkFlag(n,u),u.nocheck!==!0&&u.chkDisabled!==!0?(t.nodeChecked(n,u,e),h)||(u.check_Child_State=s&&s.length>0?e?2:0:-1):u.check_Child_State=-1,i.setChkClass(n,a,u),n.check.autoCheckTrigger&&u!=o&&u.nocheck!==!0&&u.chkDisabled!==!0&&n.treeObj.trigger(r.event.CHECK,[null,n.treeId,u]))}}},event:{},data:{getRadioCheckedList:function(n){for(var r=t.getRoot(n).radioCheckedList,i=0,u=r.length;i<u;i++)t.getNodeCache(n,r[i].tId)||(r.splice(i,1),i--,u--);return r},getCheckStatus:function(n,i){if(!n.check.enable||i.nocheck||i.chkDisabled)return null;var u=t.nodeChecked(n,i);return{checked:u,half:i.halfCheck?i.halfCheck:n.check.chkStyle==r.radio.STYLE?i.check_Child_State===2:u?i.check_Child_State>-1&&i.check_Child_State<2:i.check_Child_State>0}},getTreeCheckedNodes:function(n,i,u,f){if(!i)return[];for(var s=u&&n.check.chkStyle==r.radio.STYLE&&n.check.radioType==r.radio.TYPE_ALL,f=f?f:[],o=0,h=i.length;o<h;o++){var e=i[o],c=t.nodeChildren(n,e),l=t.nodeChecked(n,e);if(e.nocheck!==!0&&e.chkDisabled!==!0&&l==u&&(f.push(e),s))break;if(t.getTreeCheckedNodes(n,c,u,f),s&&f.length>0)break}return f},getTreeChangeCheckedNodes:function(n,i,r){if(!i)return[];for(var r=r?r:[],f=0,e=i.length;f<e;f++){var u=i[f],o=t.nodeChildren(n,u),s=t.nodeChecked(n,u);u.nocheck!==!0&&u.chkDisabled!==!0&&s!=u.checkedOld&&r.push(u);t.getTreeChangeCheckedNodes(n,o,r)}return r},makeChkFlag:function(n,i){var f,s,o,h;if(i){if(f=-1,s=t.nodeChildren(n,i),s)for(o=0,h=s.length;o<h;o++){var u=s[o],c=t.nodeChecked(n,u),e=-1;if(n.check.chkStyle==r.radio.STYLE)if(e=u.nocheck===!0||u.chkDisabled===!0?u.check_Child_State:u.halfCheck===!0?2:c?2:u.check_Child_State>0?2:0,e==2){f=2;break}else e==0&&(f=0);else if(n.check.chkStyle==r.checkbox.STYLE)if(e=u.nocheck===!0||u.chkDisabled===!0?u.check_Child_State:u.halfCheck===!0?1:c?u.check_Child_State===-1||u.check_Child_State===2?2:1:u.check_Child_State>0?1:0,e===1){f=1;break}else if(e===2&&f>-1&&o>0&&e!==f){f=1;break}else if(f===2&&e>-1&&e<2){f=1;break}else e>-1&&(f=e)}i.check_Child_State=f}}}});var n=n.fn.zTree,u=n._z.tools,r=n.consts,i=n._z.view,t=n._z.data,f=u.$;t.nodeChecked=function(n,t,i){return t?(n=n.data.key.checked,typeof i!="undefined"?(typeof i=="string"&&(i=u.eqs(i,"true")),t[n]=!!i):t[n]=typeof t[n]=="string"?u.eqs(t[n],"true"):!!t[n],t[n]):!1};t.exSetting(v);t.addInitBind(function(n){n.treeObj.bind(r.event.CHECK,function(t,i,r,f){t.srcEvent=i;u.apply(n.callback.onCheck,[t,r,f])})});t.addInitUnBind(function(n){n.treeObj.unbind(r.event.CHECK)});t.addInitCache(function(){});t.addInitNode(function(n,i,f,e){f&&(i=t.nodeChecked(n,f),f.checkedOld=i,typeof f.nocheck=="string"&&(f.nocheck=u.eqs(f.nocheck,"true")),f.nocheck=!!f.nocheck||n.check.nocheckInherit&&e&&!!e.nocheck,typeof f.chkDisabled=="string"&&(f.chkDisabled=u.eqs(f.chkDisabled,"true")),f.chkDisabled=!!f.chkDisabled||n.check.chkDisabledInherit&&e&&!!e.chkDisabled,typeof f.halfCheck=="string"&&(f.halfCheck=u.eqs(f.halfCheck,"true")),f.halfCheck=!!f.halfCheck,f.check_Child_State=-1,f.check_Focus=!1,f.getCheckStatus=function(){return t.getCheckStatus(n,f)},n.check.chkStyle==r.radio.STYLE&&n.check.radioType==r.radio.TYPE_ALL&&i&&t.getRoot(n).radioCheckedList.push(f))});t.addInitProxy(function(n){var i=n.target,o=t.getSetting(n.data.treeId),e="",h=null,f="",s=null;if(u.eqs(n.type,"mouseover")?o.check.enable&&u.eqs(i.tagName,"span")&&i.getAttribute("treeNode"+r.id.CHECK)!==null&&(e=u.getNodeMainDom(i).id,f="mouseoverCheck"):u.eqs(n.type,"mouseout")?o.check.enable&&u.eqs(i.tagName,"span")&&i.getAttribute("treeNode"+r.id.CHECK)!==null&&(e=u.getNodeMainDom(i).id,f="mouseoutCheck"):u.eqs(n.type,"click")&&o.check.enable&&u.eqs(i.tagName,"span")&&i.getAttribute("treeNode"+r.id.CHECK)!==null&&(e=u.getNodeMainDom(i).id,f="checkNode"),e.length>0)switch(h=t.getNodeCache(o,e),f){case"checkNode":s=c;break;case"mouseoverCheck":s=l;break;case"mouseoutCheck":s=a}return{stop:f==="checkNode",node:h,nodeEventType:f,nodeEventCallback:s,treeEventType:"",treeEventCallback:null}},!0);t.addInitRoot(function(n){t.getRoot(n).radioCheckedList=[]});t.addBeforeA(function(n,u,f){n.check.enable&&(t.makeChkFlag(n,u),f.push("<span ID='",u.tId,r.id.CHECK,"' class='",i.makeChkClass(n,u),"' treeNode",r.id.CHECK,u.nocheck===!0?" style='display:none;'":"","><\/span>"))});t.addZTreeTools(function(n,e){e.checkNode=function(e,o,s,h){var c=t.nodeChecked(n,e);e.chkDisabled!==!0&&(o!==!0&&o!==!1&&(o=!c),h=!!h,(c!==o||s)&&!(h&&u.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0)==!1)&&u.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==!0)&&(t.nodeChecked(n,e,o),o=f(e,r.id.CHECK,this.setting),(s||this.setting.check.chkStyle===r.radio.STYLE)&&i.checkNodeRelation(this.setting,e),i.setChkClass(this.setting,o,e),i.repairParentChkClassWithSelf(this.setting,e),h&&this.setting.treeObj.trigger(r.event.CHECK,[null,this.setting.treeId,e]))};e.checkAllNodes=function(n){i.repairAllChk(this.setting,!!n)};e.getCheckedNodes=function(i){var i=i!==!1,r=t.nodeChildren(n,t.getRoot(this.setting));return t.getTreeCheckedNodes(this.setting,r,i)};e.getChangeCheckedNodes=function(){var i=t.nodeChildren(n,t.getRoot(this.setting));return t.getTreeChangeCheckedNodes(this.setting,i)};e.setChkDisabled=function(n,t,r,u){t=!!t;r=!!r;i.repairSonChkDisabled(this.setting,n,t,!!u);i.repairParentChkDisabled(this.setting,n.getParentNode(),t,r)};var o=e.updateNode;e.updateNode=function(n,t){if(o&&o.apply(e,arguments),n&&this.setting.check.enable&&f(n,this.setting).get(0)&&u.uCanDo(this.setting)){var s=f(n,r.id.CHECK,this.setting);(t==!0||this.setting.check.chkStyle===r.radio.STYLE)&&i.checkNodeRelation(this.setting,n);i.setChkClass(this.setting,s,n);i.repairParentChkClassWithSelf(this.setting,n)}}});o=i.createNodes;i.createNodes=function(n,t,r,u){o&&o.apply(i,arguments);r&&i.repairParentChkClassWithSelf(n,u)};s=i.removeNode;i.removeNode=function(n,t){var r=t.getParentNode();s&&s.apply(i,arguments);t&&r&&(i.repairChkClass(n,r),i.repairParentChkClass(n,r))};h=i.appendNodes;i.appendNodes=function(n,r,u,f){var e="";return h&&(e=h.apply(i,arguments)),f&&t.makeChkFlag(n,f),e}}(jQuery),function(n){var e={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},o={onHoverOverNode:function(n,t){var u=r.getSetting(n.data.treeId),f=r.getRoot(u);if(f.curHoverNode!=t)o.onHoverOutNode(n);f.curHoverNode=t;i.addHoverDom(u,t)},onHoverOutNode:function(n){var n=r.getSetting(n.data.treeId),t=r.getRoot(n);t.curHoverNode&&!r.isSelectedNode(n,t.curHoverNode)&&(i.removeTreeDom(n,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(o,s){function ot(o){var d,lt,s,nt,wt,st,at,ii,ht,ot;if(w.dragFlag==0&&Math.abs(yt-o.clientX)<h.edit.drag.minMoveSize&&Math.abs(pt-o.clientY)<h.edit.drag.minMoveSize)return!0;if(tt.css("cursor","pointer"),w.dragFlag==0){if(u.apply(h.callback.beforeDrag,[h.treeId,l],!0)==!1)return it(o),!0;for(d=0,lt=l.length;d<lt;d++)d==0&&(w.dragNodeShowBefore=[]),s=l[d],r.nodeIsParent(h,s)&&s.open?(i.expandCollapseNode(h,s,!s.open),w.dragNodeShowBefore[s.tId]=!0):w.dragNodeShowBefore[s.tId]=!1;if(w.dragFlag=1,ct.showHoverDom=!1,u.showIfameMask(h,!0),nt=!0,ot=-1,l.length>1)for(wt=l[0].parentTId?r.nodeChildren(h,l[0].getParentNode()):r.getNodes(h),s=[],d=0,lt=wt.length;d<lt;d++)if(w.dragNodeShowBefore[wt[d].tId]!==void 0&&(nt&&ot>-1&&ot+1!==d&&(nt=!1),s.push(wt[d]),ot=d),l.length===s.length){l=s;break}for(nt&&(rt=l[0].getPreNode(),ut=l[l.length-1].getNextNode()),k=f("<ul class='zTreeDragUL'><\/ul>",h),d=0,lt=l.length;d<lt;d++)s=l[d],s.editNameFlag=!1,i.selectNode(h,s,d>0),i.removeTreeDom(h,s),d>h.edit.drag.maxShowNodeNum-1||(nt=f("<li id='"+s.tId+"_tmp'><\/li>",h),nt.append(f(s,t.id.A,h).clone()),nt.css("padding","0"),nt.children("#"+s.tId+t.id.A).removeClass(t.node.CURSELECTED),k.append(nt),d==h.edit.drag.maxShowNodeNum-1&&(nt=f("<li id='"+s.tId+"_moretmp'><a>  ...  <\/a><\/li>",h),k.append(nt)));k.attr("id",l[0].tId+t.id.UL+"_tmp");k.addClass(h.treeObj.attr("class"));k.appendTo(tt);p=f("<span class='tmpzTreeMove_arrow'><\/span>",h);p.attr("id","zTreeMove_arrow_tmp");p.appendTo(tt);h.treeObj.trigger(t.event.DRAG,[o,h.treeId,l])}if(w.dragFlag==1){a&&p.attr("id")==o.target.id&&v&&o.clientX+b.scrollLeft()+2>n("#"+v+t.id.A,a).offset().left?(s=n("#"+v+t.id.A,a),o.target=s.length>0?s.get(0):o.target):a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER));v=a=null;g=!1;c=h;s=r.getSettings();for(st in s)s[st].treeId&&s[st].edit.enable&&s[st].treeId!=h.treeId&&(o.target.id==s[st].treeId||n(o.target).parents("#"+s[st].treeId).length>0)&&(g=!0,c=s[st]);st=b.scrollTop();nt=b.scrollLeft();ot=c.treeObj.offset();d=c.treeObj.get(0).scrollHeight;s=c.treeObj.get(0).scrollWidth;lt=o.clientY+st-ot.top;var kt=c.treeObj.height()+ot.top-o.clientY-st,gt=o.clientX+nt-ot.left,dt=c.treeObj.width()+ot.left-o.clientX-nt,ot=lt<h.edit.drag.borderMax&&lt>h.edit.drag.borderMin,wt=kt<h.edit.drag.borderMax&&kt>h.edit.drag.borderMin,bt=gt<h.edit.drag.borderMax&&gt>h.edit.drag.borderMin,ni=dt<h.edit.drag.borderMax&&dt>h.edit.drag.borderMin,kt=lt>h.edit.drag.borderMin&&kt>h.edit.drag.borderMin&&gt>h.edit.drag.borderMin&&dt>h.edit.drag.borderMin,gt=ot&&c.treeObj.scrollTop()<=0,dt=wt&&c.treeObj.scrollTop()+c.treeObj.height()+10>=d,ti=bt&&c.treeObj.scrollLeft()<=0,ri=ni&&c.treeObj.scrollLeft()+c.treeObj.width()+10>=s;if(o.target&&u.isChildOrSelf(o.target,c.treeId)){for(at=o.target;at&&at.tagName&&!u.eqs(at.tagName,"li")&&at.id!=c.treeId;)at=at.parentNode;for(ii=!0,d=0,lt=l.length;d<lt;d++)if(s=l[d],at.id===s.tId){ii=!1;break}else if(f(s,h).find("#"+at.id).length>0){ii=!1;break}ii&&o.target&&u.isChildOrSelf(o.target,at.id+t.id.A)&&(a=n(at),v=at.id)}s=l[0];kt&&u.isChildOrSelf(o.target,c.treeId)&&(!a&&(o.target.id==c.treeId||gt||dt||ti||ri)&&(g||!g&&s.parentTId)&&(a=c.treeObj),ot?c.treeObj.scrollTop(c.treeObj.scrollTop()-10):wt&&c.treeObj.scrollTop(c.treeObj.scrollTop()+10),bt?c.treeObj.scrollLeft(c.treeObj.scrollLeft()-10):ni&&c.treeObj.scrollLeft(c.treeObj.scrollLeft()+10),a&&a!=c.treeObj&&a.offset().left<c.treeObj.offset().left&&c.treeObj.scrollLeft(c.treeObj.scrollLeft()+a.offset().left-c.treeObj.offset().left));k.css({top:o.clientY+st+3+"px",left:o.clientX+nt+3+"px"});d=nt=0;a&&a.attr("id")!=c.treeId?(ht=v==null?null:r.getNodeCache(c,v),ot=(o.ctrlKey||o.metaKey)&&h.edit.drag.isMove&&h.edit.drag.isCopy||!h.edit.drag.isMove&&h.edit.drag.isCopy,lt=!!(rt&&v===rt.tId),bt=!!(ut&&v===ut.tId),wt=s.parentTId&&s.parentTId==v,s=(ot||!bt)&&u.apply(c.edit.drag.prev,[c.treeId,l,ht],!!c.edit.drag.prev),lt=(ot||!lt)&&u.apply(c.edit.drag.next,[c.treeId,l,ht],!!c.edit.drag.next),ot=(ot||!wt)&&!(c.data.keep.leaf&&!r.nodeIsParent(h,ht))&&u.apply(c.edit.drag.inner,[c.treeId,l,ht],!!c.edit.drag.inner),wt=function(){a=null;v="";y=t.move.TYPE_INNER;p.css({display:"none"});window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},s||lt||ot?(bt=n("#"+v+t.id.A,a),ni=ht.isLastNode?null:n("#"+ht.getNextNode().tId+t.id.A,a.next()),kt=bt.offset().top,gt=bt.offset().left,dt=s?ot?.25:lt?.5:1:-1,ti=lt?ot?.75:s?.5:0:-1,st=(o.clientY+st-kt)/bt.height(),(dt==1||st<=dt&&st>=-.2)&&s?(nt=1-p.width(),d=kt-p.height()/2,y=t.move.TYPE_PREV):(ti==0||st>=ti&&st<=1.2)&&lt?(nt=1-p.width(),d=ni==null||r.nodeIsParent(h,ht)&&ht.open?kt+bt.height()-p.height()/2:ni.offset().top-p.height()/2,y=t.move.TYPE_NEXT):ot?(nt=5-p.width(),d=kt,y=t.move.TYPE_INNER):wt(),a)&&(p.css({display:"block",top:d+"px",left:gt+nt+"px"}),bt.addClass(t.node.TMPTARGET_NODE+"_"+y),(ft!=v||et!=y)&&(vt=(new Date).getTime()),ht&&r.nodeIsParent(h,ht)&&y==t.move.TYPE_INNER&&(st=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==ht.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===ht.tId&&(st=!1),st)&&(window.zTreeMoveTimer=setTimeout(function(){y==t.move.TYPE_INNER&&ht&&r.nodeIsParent(h,ht)&&!ht.open&&(new Date).getTime()-vt>c.edit.drag.autoOpenTime&&u.apply(c.callback.beforeDragOpen,[c.treeId,ht],!0)&&(i.switchNode(c,ht),c.edit.drag.autoExpandTrigger&&c.treeObj.trigger(t.event.EXPAND,[c.treeId,ht]))},c.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=ht.tId)):wt()):(y=t.move.TYPE_INNER,a&&u.apply(c.edit.drag.inner,[c.treeId,l,null],!!c.edit.drag.inner)?a.addClass(t.node.TMPTARGET_TREE):a=null,p.css({display:"none"}),window.zTreeMoveTimer)&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);ft=v;et=y;h.treeObj.trigger(t.event.DRAGMOVE,[o,h.treeId,l])}return!1}function it(o){var rt,ht,ut,nt,s,d;if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),et=ft=null,b.unbind("mousemove",ot),b.unbind("mouseup",it),b.unbind("selectstart",st),tt.css("cursor",""),a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER)),u.showIfameMask(h,!1),ct.showHoverDom=!0,w.dragFlag!=0){for(w.dragFlag=0,rt=0,ht=l.length;rt<ht;rt++)ut=l[rt],r.nodeIsParent(h,ut)&&w.dragNodeShowBefore[ut.tId]&&!ut.open&&(i.expandCollapseNode(h,ut,!ut.open),delete w.dragNodeShowBefore[ut.tId]);k&&k.remove();p&&p.remove();nt=(o.ctrlKey||o.metaKey)&&h.edit.drag.isMove&&h.edit.drag.isCopy||!h.edit.drag.isMove&&h.edit.drag.isCopy;!nt&&a&&v&&l[0].parentTId&&v==l[0].parentTId&&y==t.move.TYPE_INNER&&(a=null);a?(s=v==null?null:r.getNodeCache(c,v),u.apply(h.callback.beforeDrop,[c.treeId,l,s,y,nt],!0)==!1?i.selectNodes(at,l):(d=nt?u.clone(l):l,rt=function(){if(g){if(!nt)for(var n=0,r=l.length;n<r;n++)i.removeNode(h,l[n]);y==t.move.TYPE_INNER?i.addNodes(c,s,-1,d):i.addNodes(c,s.getParentNode(),y==t.move.TYPE_PREV?s.getIndex():s.getIndex()+1,d)}else if(nt&&y==t.move.TYPE_INNER)i.addNodes(c,s,-1,d);else if(nt)i.addNodes(c,s.getParentNode(),y==t.move.TYPE_PREV?s.getIndex():s.getIndex()+1,d);else if(y!=t.move.TYPE_NEXT)for(n=0,r=d.length;n<r;n++)i.moveNode(c,s,d[n],y,!1);else for(n=-1,r=d.length-1;n<r;r--)i.moveNode(c,s,d[r],y,!1);i.selectNodes(c,d);n=f(d[0],h).get(0);i.scrollIntoView(h,n);h.treeObj.trigger(t.event.DROP,[o,c.treeId,d,s,y,nt])},y==t.move.TYPE_INNER&&u.canAsync(c,s)?i.asyncNode(c,s,!1,rt):rt())):(i.selectNodes(at,l),h.treeObj.trigger(t.event.DROP,[o,h.treeId,l,null,null,null]))}}function st(){return!1}var d,ht,h=r.getSetting(o.data.treeId),w=r.getRoot(h),ct=r.getRoots();if(o.button==2||!h.edit.enable||!h.edit.drag.isCopy&&!h.edit.drag.isMove)return!0;var lt=o.target,nt=r.getRoot(h).curSelectedList,l=[];if(r.isSelectedNode(h,s))for(d=0,ht=nt.length;d<ht;d++){if(nt[d].editNameFlag&&u.eqs(lt.tagName,"input")&&lt.getAttribute("treeNode"+t.id.INPUT)!==null)return!0;if(l.push(nt[d]),l[0].parentTId!==nt[d].parentTId){l=[s];break}}else l=[s];i.editNodeBlur=!0;i.cancelCurEditNode(h);var b=n(h.treeObj.get(0).ownerDocument),tt=n(h.treeObj.get(0).ownerDocument.body),k,p,a,g=!1,c=h,at=h,rt,ut,ft=null,et=null,v=null,y=t.move.TYPE_INNER,yt=o.clientX,pt=o.clientY,vt=(new Date).getTime();return u.uCanDo(h)&&b.bind("mousemove",ot),b.bind("mouseup",it),b.bind("selectstart",st),!0}},h,c,y,l,a,v;n.extend(!0,n.fn.zTree.consts,e);n.extend(!0,n.fn.zTree._z,{tools:{getAbs:function(n){return n=n.getBoundingClientRect(),[n.left+(document.body.scrollLeft+document.documentElement.scrollLeft),n.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(n){n.get(0)&&(n.focus(),u.setCursorPosition(n.get(0),n.val().length))},inputSelect:function(n){n.get(0)&&(n.focus(),n.select())},setCursorPosition:function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},showIfameMask:function(n,t){for(var i=r.getRoot(n);i.dragMaskList.length>0;)i.dragMaskList[0].remove(),i.dragMaskList.shift();if(t)for(var s=f("iframe",n),o=0,c=s.length;o<c;o++){var e=s.get(o),h=u.getAbs(e),e=f("<div id='zTreeMask_"+o+"' class='zTreeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+e.offsetWidth+"px; height:"+e.offsetHeight+"px;'><\/div>",n);e.appendTo(f("body",n));i.dragMaskList.push(e)}}},view:{addEditBtn:function(n,r){if(!(r.editNameFlag||f(r,t.id.EDIT,n).length>0)&&u.apply(n.edit.showRenameBtn,[n.treeId,r],n.edit.showRenameBtn)){var e=f(r,t.id.A,n),o="<span class='"+t.className.BUTTON+" edit' id='"+r.tId+t.id.EDIT+"' title='"+u.apply(n.edit.renameTitle,[n.treeId,r],n.edit.renameTitle)+"' treeNode"+t.id.EDIT+" style='display:none;'><\/span>";e.append(o);f(r,t.id.EDIT,n).bind("click",function(){return!u.uCanDo(n)||u.apply(n.callback.beforeEditName,[n.treeId,r],!0)==!1?!1:(i.editNode(n,r),!1)}).show()}},addRemoveBtn:function(n,r){if(!(r.editNameFlag||f(r,t.id.REMOVE,n).length>0)&&u.apply(n.edit.showRemoveBtn,[n.treeId,r],n.edit.showRemoveBtn)){var e=f(r,t.id.A,n),o="<span class='"+t.className.BUTTON+" remove' id='"+r.tId+t.id.REMOVE+"' title='"+u.apply(n.edit.removeTitle,[n.treeId,r],n.edit.removeTitle)+"' treeNode"+t.id.REMOVE+" style='display:none;'><\/span>";e.append(o);f(r,t.id.REMOVE,n).bind("click",function(){return!u.uCanDo(n)||u.apply(n.callback.beforeRemove,[n.treeId,r],!0)==!1?!1:(i.removeNode(n,r),n.treeObj.trigger(t.event.REMOVE,[n.treeId,r]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(n,t){r.getRoots().showHoverDom&&(t.isHover=!0,n.edit.enable&&(i.addEditBtn(n,t),i.addRemoveBtn(n,t)),u.apply(n.view.addHoverDom,[n.treeId,t]))},cancelCurEditNode:function(n,e,o){var h=r.getRoot(n),s=h.curEditNode,c,e;if(s){if(c=h.curEditInput,e=e?e:o?r.nodeName(n,s):c.val(),u.apply(n.callback.beforeRename,[n.treeId,s,e,o],!0)===!1)return!1;r.nodeName(n,s,e);f(s,t.id.A,n).removeClass(t.node.CURSELECTED_EDIT);c.unbind();i.setNodeName(n,s);s.editNameFlag=!1;h.curEditNode=null;h.curEditInput=null;i.selectNode(n,s,!1);n.treeObj.trigger(t.event.RENAME,[n.treeId,s,o])}return h.noSelection=!0},editNode:function(n,e){var s=r.getRoot(n),o;i.editNodeBlur=!1;r.isSelectedNode(n,e)&&s.curEditNode==e&&e.editNameFlag?setTimeout(function(){u.inputFocus(s.curEditInput)},0):(e.editNameFlag=!0,i.removeTreeDom(n,e),i.cancelCurEditNode(n),i.selectNode(n,e,!1),f(e,t.id.SPAN,n).html("<input type=text class='rename' id='"+e.tId+t.id.INPUT+"' treeNode"+t.id.INPUT+" >"),o=f(e,t.id.INPUT,n),o.attr("value",r.nodeName(n,e)),n.edit.editNameSelectAll?u.inputSelect(o):u.inputFocus(o),o.bind("blur",function(){i.editNodeBlur||i.cancelCurEditNode(n)}).bind("keydown",function(t){t.keyCode=="13"?(i.editNodeBlur=!0,i.cancelCurEditNode(n)):t.keyCode=="27"&&i.cancelCurEditNode(n,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),f(e,t.id.A,n).addClass(t.node.CURSELECTED_EDIT),s.curEditInput=o,s.noSelection=!1,s.curEditNode=e)},moveNode:function(n,u,e,o,s,h){var l=r.getRoot(n),v,c,a,y,d;if(u!=e&&(!n.data.keep.leaf||!u||r.nodeIsParent(n,u)||o!=t.move.TYPE_INNER)){v=e.parentTId?e.getParentNode():l;c=u===null||u==l;c&&u===null&&(u=l);c&&(o=t.move.TYPE_INNER);l=u.parentTId?u.getParentNode():l;o!=t.move.TYPE_PREV&&o!=t.move.TYPE_NEXT&&(o=t.move.TYPE_INNER);o==t.move.TYPE_INNER&&(c?e.parentTId=null:(r.nodeIsParent(n,u)||(r.nodeIsParent(n,u,!0),u.open=!!u.open,i.setNodeLineIcos(n,u)),e.parentTId=u.tId));c?a=c=n.treeObj:(!h&&o==t.move.TYPE_INNER?i.expandCollapseNode(n,u,!0,!1):h||i.expandCollapseNode(n,u.getParentNode(),!0,!1),c=f(u,n),a=f(u,t.id.UL,n),c.get(0)&&!a.get(0)&&(a=[],i.makeUlHtml(n,u,a,""),c.append(a.join(""))),a=f(u,t.id.UL,n));y=f(e,n);y.get(0)?c.get(0)||y.remove():y=i.appendNodes(n,e.level,[e],null,-1,!1,!0).join("");a.get(0)&&o==t.move.TYPE_INNER?a.append(y):c.get(0)&&o==t.move.TYPE_PREV?c.before(y):c.get(0)&&o==t.move.TYPE_NEXT&&c.after(y);a=-1;var y=0,b=null,c=null,g=e.level,p=r.nodeChildren(n,v),k=r.nodeChildren(n,l),w=r.nodeChildren(n,u);if(e.isFirstNode)(a=0,p.length>1)&&(b=p[1],b.isFirstNode=!0);else if(e.isLastNode)a=p.length-1,b=p[a-1],b.isLastNode=!0;else for(l=0,d=p.length;l<d;l++)if(p[l].tId==e.tId){a=l;break}if(a>=0&&p.splice(a,1),o!=t.move.TYPE_INNER)for(l=0,d=k.length;l<d;l++)k[l].tId==u.tId&&(y=l);o==t.move.TYPE_INNER?(w||(w=r.nodeChildren(n,u,[])),w.length>0&&(c=w[w.length-1],c.isLastNode=!1),w.splice(w.length,0,e),e.isLastNode=!0,e.isFirstNode=w.length==1):u.isFirstNode&&o==t.move.TYPE_PREV?(k.splice(y,0,e),c=u,c.isFirstNode=!1,e.parentTId=u.parentTId,e.isFirstNode=!0,e.isLastNode=!1):u.isLastNode&&o==t.move.TYPE_NEXT?(k.splice(y+1,0,e),c=u,c.isLastNode=!1,e.parentTId=u.parentTId,e.isFirstNode=!1,e.isLastNode=!0):(o==t.move.TYPE_PREV?k.splice(y,0,e):k.splice(y+1,0,e),e.parentTId=u.parentTId,e.isFirstNode=!1,e.isLastNode=!1);r.fixPIdKeyValue(n,e);r.setSonNodeLevel(n,e.getParentNode(),e);i.setNodeLineIcos(n,e);i.repairNodeLevelClass(n,e,g);!n.data.keep.parent&&p.length<1?(r.nodeIsParent(n,v,!1),v.open=!1,u=f(v,t.id.UL,n),o=f(v,t.id.SWITCH,n),l=f(v,t.id.ICON,n),i.replaceSwitchClass(v,o,t.folder.DOCU),i.replaceIcoClass(v,l,t.folder.DOCU),u.css("display","none")):b&&i.setNodeLineIcos(n,b);c&&i.setNodeLineIcos(n,c);n.check&&n.check.enable&&i.repairChkClass&&(i.repairChkClass(n,v),i.repairParentChkClassWithSelf(n,v),v!=e.parent&&i.repairParentChkClassWithSelf(n,e));h||i.expandCollapseParentNode(n,e.getParentNode(),!0,s)}},removeEditBtn:function(n,i){f(i,t.id.EDIT,n).unbind().remove()},removeRemoveBtn:function(n,i){f(i,t.id.REMOVE,n).unbind().remove()},removeTreeDom:function(n,t){t.isHover=!1;i.removeEditBtn(n,t);i.removeRemoveBtn(n,t);u.apply(n.view.removeHoverDom,[n.treeId,t])},repairNodeLevelClass:function(n,i,r){if(r!==i.level){var u=f(i,n),e=f(i,t.id.A,n),n=f(i,t.id.UL,n),r=t.className.LEVEL+r,i=t.className.LEVEL+i.level;u.removeClass(r);u.addClass(i);e.removeClass(r);e.addClass(i);n.removeClass(r);n.addClass(i)}},selectNodes:function(n,t){for(var r=0,u=t.length;r<u;r++)i.selectNode(n,t[r],r>0)}},event:{},data:{setSonNodeLevel:function(n,t,i){var u,t,f;if(i&&(u=r.nodeChildren(n,i),i.level=t?t.level+1:0,u))for(t=0,f=u.length;t<f;t++)u[t]&&r.setSonNodeLevel(n,i,u[t])}}});var s=n.fn.zTree,u=s._z.tools,t=s.consts,i=s._z.view,r=s._z.data,f=u.$;r.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});r.addInitBind(function(n){var i=n.treeObj,r=t.event;i.bind(r.RENAME,function(t,i,r,f){u.apply(n.callback.onRename,[t,i,r,f])});i.bind(r.DRAG,function(t,i,r,f){u.apply(n.callback.onDrag,[i,r,f])});i.bind(r.DRAGMOVE,function(t,i,r,f){u.apply(n.callback.onDragMove,[i,r,f])});i.bind(r.DROP,function(t,i,r,f,e,o,s){u.apply(n.callback.onDrop,[i,r,f,e,o,s])})});r.addInitUnBind(function(n){var n=n.treeObj,i=t.event;n.unbind(i.RENAME);n.unbind(i.DRAG);n.unbind(i.DRAGMOVE);n.unbind(i.DROP)});r.addInitCache(function(){});r.addInitNode(function(n,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)});r.addInitProxy(function(n){var c=n.target,s=r.getSetting(n.data.treeId),a=n.relatedTarget,f="",l=null,e="",h=null,i=null;if(u.eqs(n.type,"mouseover")?(i=u.getMDom(s,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]))&&(f=u.getNodeMainDom(i).id,e="hoverOverNode"):u.eqs(n.type,"mouseout")?(i=u.getMDom(s,a,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i||(f="remove",e="hoverOutNode")):u.eqs(n.type,"mousedown")&&(i=u.getMDom(s,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]))&&(f=u.getNodeMainDom(i).id,e="mousedownNode"),f.length>0)switch(l=r.getNodeCache(s,f),e){case"mousedownNode":h=o.onMousedownNode;break;case"hoverOverNode":h=o.onHoverOverNode;break;case"hoverOutNode":h=o.onHoverOutNode}return{stop:!1,node:l,nodeEventType:e,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}});r.addInitRoot(function(n){var n=r.getRoot(n),t=r.getRoots();n.curEditNode=null;n.curEditInput=null;n.curHoverNode=null;n.dragFlag=0;n.dragNodeShowBefore=[];n.dragMaskList=[];t.showHoverDom=!0});r.addZTreeTools(function(n,e){e.cancelEditName=function(n){r.getRoot(this.setting).curEditNode&&i.cancelCurEditNode(this.setting,n?n:null,!0)};e.copyNode=function(f,e,o,s){var c,l,h;return e?(c=r.nodeIsParent(n,f),f&&!c&&this.setting.data.keep.leaf&&o===t.move.TYPE_INNER)?null:(l=this,h=u.clone(e),f||(f=null,o=t.move.TYPE_INNER),o==t.move.TYPE_INNER?(e=function(){i.addNodes(l.setting,f,-1,[h],s)},u.canAsync(this.setting,f)?i.asyncNode(this.setting,f,s,e):e()):(i.addNodes(this.setting,f.parentNode,-1,[h],s),i.moveNode(this.setting,f,h,o,!1,s)),h):null};e.editName=function(n){n&&n.tId&&n===r.getNodeCache(this.setting,n.tId)&&(n.parentTId&&i.expandCollapseParentNode(this.setting,n.getParentNode(),!0),i.editNode(this.setting,n))};e.moveNode=function(e,o,s,h){function c(){i.moveNode(a.setting,e,o,s,!1,h)}var l,a;return o?(l=r.nodeIsParent(n,e),e&&!l&&this.setting.data.keep.leaf&&s===t.move.TYPE_INNER)?null:e&&(o.parentTId==e.tId&&s==t.move.TYPE_INNER||f(o,this.setting).find("#"+e.tId).length>0)?null:(e||(e=null),a=this,u.canAsync(this.setting,e)&&s===t.move.TYPE_INNER?i.asyncNode(this.setting,e,h,c):c(),o):o};e.setEditable=function(n){return this.setting.edit.enable=n,this.refresh()}});h=i.cancelPreSelectedNode;i.cancelPreSelectedNode=function(n,t){for(var f=r.getRoot(n).curSelectedList,u=0,e=f.length;u<e;u++)if((!t||t===f[u])&&(i.removeTreeDom(n,f[u]),t))break;h&&h.apply(i,arguments)};c=i.createNodes;i.createNodes=function(n,t,r,u){c&&c.apply(i,arguments);r&&i.repairParentChkClassWithSelf&&i.repairParentChkClassWithSelf(n,u)};y=i.makeNodeUrl;i.makeNodeUrl=function(n){return n.edit.enable?null:y.apply(i,arguments)};l=i.removeNode;i.removeNode=function(n,t){var u=r.getRoot(n);u.curEditNode===t&&(u.curEditNode=null);l&&l.apply(i,arguments)};a=i.selectNode;i.selectNode=function(n,t){var u=r.getRoot(n);return r.isSelectedNode(n,t)&&u.curEditNode==t&&t.editNameFlag?!1:(a&&a.apply(i,arguments),i.addHoverDom(n,t),!0)};v=u.uCanDo;u.uCanDo=function(n,t){var f=r.getRoot(n);return t&&(u.eqs(t.type,"mouseover")||u.eqs(t.type,"mouseout")||u.eqs(t.type,"mousedown")||u.eqs(t.type,"mouseup"))?!0:(f.curEditNode&&(i.editNodeBlur=!1,f.curEditInput.focus()),!f.curEditNode&&(v?v.apply(i,arguments):!0))}}(jQuery);